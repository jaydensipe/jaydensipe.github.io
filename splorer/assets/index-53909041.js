(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var ct=Object.freeze({Linear:Object.freeze({None:function(i){return i},In:function(i){return this.None(i)},Out:function(i){return this.None(i)},InOut:function(i){return this.None(i)}}),Quadratic:Object.freeze({In:function(i){return i*i},Out:function(i){return i*(2-i)},InOut:function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}}),Cubic:Object.freeze({In:function(i){return i*i*i},Out:function(i){return--i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}}),Quartic:Object.freeze({In:function(i){return i*i*i*i},Out:function(i){return 1- --i*i*i*i},InOut:function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}}),Quintic:Object.freeze({In:function(i){return i*i*i*i*i},Out:function(i){return--i*i*i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}}),Sinusoidal:Object.freeze({In:function(i){return 1-Math.sin((1-i)*Math.PI/2)},Out:function(i){return Math.sin(i*Math.PI/2)},InOut:function(i){return .5*(1-Math.sin(Math.PI*(.5-i)))}}),Exponential:Object.freeze({In:function(i){return i===0?0:Math.pow(1024,i-1)},Out:function(i){return i===1?1:1-Math.pow(2,-10*i)},InOut:function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}}),Circular:Object.freeze({In:function(i){return 1-Math.sqrt(1-i*i)},Out:function(i){return Math.sqrt(1- --i*i)},InOut:function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}}),Elastic:Object.freeze({In:function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out:function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut:function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(i){var t=1.70158;return i===1?1:i*i*((t+1)*i-t)},Out:function(i){var t=1.70158;return i===0?0:--i*i*((t+1)*i+t)+1},InOut:function(i){var t=2.5949095;return(i*=2)<1?.5*(i*i*((t+1)*i-t)):.5*((i-=2)*i*((t+1)*i+t)+2)}}),Bounce:Object.freeze({In:function(i){return 1-ct.Bounce.Out(1-i)},Out:function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut:function(i){return i<.5?ct.Bounce.In(i*2)*.5:ct.Bounce.Out(i*2-1)*.5+.5}}),generatePow:function(i){return i===void 0&&(i=4),i=i<Number.EPSILON?Number.EPSILON:i,i=i>1e4?1e4:i,{In:function(t){return Math.pow(t,i)},Out:function(t){return 1-Math.pow(1-t,i)},InOut:function(t){return t<.5?Math.pow(t*2,i)/2:(1-Math.pow(2-t*2,i))/2+.5}}}}),Pe=function(){return performance.now()},to=function(){function i(){this._tweens={},this._tweensAddedDuringUpdate={}}return i.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(e){return t._tweens[e]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},i.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},i.prototype.update=function(t,e){t===void 0&&(t=Pe()),e===void 0&&(e=!1);var n=Object.keys(this._tweens);if(n.length===0)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var s=this._tweens[n[r]],o=!e;s&&s.update(t,o)===!1&&!e&&delete this._tweens[n[r]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},i}(),we={Linear:function(i,t){var e=i.length-1,n=e*t,r=Math.floor(n),s=we.Utils.Linear;return t<0?s(i[0],i[1],n):t>1?s(i[e],i[e-1],e-n):s(i[r],i[r+1>e?e:r+1],n-r)},Bezier:function(i,t){for(var e=0,n=i.length-1,r=Math.pow,s=we.Utils.Bernstein,o=0;o<=n;o++)e+=r(1-t,n-o)*r(t,o)*i[o]*s(n,o);return e},CatmullRom:function(i,t){var e=i.length-1,n=e*t,r=Math.floor(n),s=we.Utils.CatmullRom;return i[0]===i[e]?(t<0&&(r=Math.floor(n=e*(1+t))),s(i[(r-1+e)%e],i[r],i[(r+1)%e],i[(r+2)%e],n-r)):t<0?i[0]-(s(i[0],i[0],i[1],i[1],-n)-i[0]):t>1?i[e]-(s(i[e],i[e],i[e-1],i[e-1],n-e)-i[e]):s(i[r?r-1:0],i[r],i[e<r+1?e:r+1],i[e<r+2?e:r+2],n-r)},Utils:{Linear:function(i,t,e){return(t-i)*e+i},Bernstein:function(i,t){var e=we.Utils.Factorial;return e(i)/e(t)/e(i-t)},Factorial:function(){var i=[1];return function(t){var e=1;if(i[t])return i[t];for(var n=t;n>1;n--)e*=n;return i[t]=e,e}}(),CatmullRom:function(i,t,e,n,r){var s=(e-i)*.5,o=(n-t)*.5,a=r*r,h=r*a;return(2*t-2*e+s+o)*h+(-3*t+3*e-2*s-o)*a+s*r+t}}},eo=function(){function i(){}return i.nextId=function(){return i._nextId++},i._nextId=0,i}(),An=new to,Ht=function(){function i(t,e){e===void 0&&(e=An),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ct.Linear.None,this._interpolationFunction=we.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=eo.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.to=function(t,e){if(e===void 0&&(e=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=e,this},i.prototype.duration=function(t){return t===void 0&&(t=1e3),this._duration=t,this},i.prototype.dynamic=function(t){return t===void 0&&(t=!1),this._isDynamic=t,this},i.prototype.start=function(t,e){if(t===void 0&&(t=Pe()),e===void 0&&(e=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||e){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,e)}return this},i.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},i.prototype._setupProperties=function(t,e,n,r,s){for(var o in n){var a=t[o],h=Array.isArray(a),c=h?"array":typeof a,l=!h&&Array.isArray(n[o]);if(!(c==="undefined"||c==="function")){if(l){var u=n[o];if(u.length===0)continue;for(var f=[a],d=0,m=u.length;d<m;d+=1){var p=this._handleRelativeValue(a,u[d]);if(isNaN(p)){l=!1,console.warn("Found invalid interpolation list. Skipping.");break}f.push(p)}l&&(n[o]=f)}if((c==="object"||h)&&a&&!l){e[o]=h?[]:{};var y=a;for(var x in y)e[o][x]=y[x];r[o]=h?[]:{};var u=n[o];if(!this._isDynamic){var g={};for(var x in u)g[x]=u[x];n[o]=u=g}this._setupProperties(y,e[o],u,r[o],s)}else(typeof e[o]>"u"||s)&&(e[o]=a),h||(e[o]*=1),l?r[o]=n[o].slice().reverse():r[o]=e[o]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},i.prototype.pause=function(t){return t===void 0&&(t=Pe()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this),this)},i.prototype.resume=function(t){return t===void 0&&(t=Pe()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},i.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},i.prototype.group=function(t){return t===void 0&&(t=An),this._group=t,this},i.prototype.delay=function(t){return t===void 0&&(t=0),this._delayTime=t,this},i.prototype.repeat=function(t){return t===void 0&&(t=0),this._initialRepeat=t,this._repeat=t,this},i.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},i.prototype.yoyo=function(t){return t===void 0&&(t=!1),this._yoyo=t,this},i.prototype.easing=function(t){return t===void 0&&(t=ct.Linear.None),this._easingFunction=t,this},i.prototype.interpolation=function(t){return t===void 0&&(t=we.Linear),this._interpolationFunction=t,this},i.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},i.prototype.onStart=function(t){return this._onStartCallback=t,this},i.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},i.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},i.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},i.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},i.prototype.onStop=function(t){return this._onStopCallback=t,this},i.prototype.update=function(t,e){if(t===void 0&&(t=Pe()),e===void 0&&(e=!0),this._isPaused)return!0;var n,r,s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>s)return!1;e&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=this._duration===0||r>1?1:r;var o=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),r===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(n in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[n]=="string"&&(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,h=this._chainedTweens.length;a<h;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(t,e,n,r){for(var s in n)if(e[s]!==void 0){var o=e[s]||0,a=n[s],h=Array.isArray(t[s]),c=Array.isArray(a),l=!h&&c;l?t[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(t[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(t[s]=o+(a-o)*r))}},i.prototype._handleRelativeValue=function(t,e){return typeof e!="string"?e:e.charAt(0)==="+"||e.charAt(0)==="-"?t+parseFloat(e):parseFloat(e)},i.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];typeof n=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(n):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=e},i}(),Mt=An;Mt.getAll.bind(Mt);Mt.removeAll.bind(Mt);Mt.add.bind(Mt);Mt.remove.bind(Mt);var io=Mt.update.bind(Mt);/* @license twgl.js 5.4.1 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */let H=Float32Array;function no(i){const t=H;return H=i,t}function It(i,t,e){const n=new H(3);return i&&(n[0]=i),t&&(n[1]=t),e&&(n[2]=e),n}function ro(i,t,e){return e=e||new H(3),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function Zr(i,t,e){return e=e||new H(3),e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e}function so(i,t,e,n){return n=n||new H(3),n[0]=i[0]+e*(t[0]-i[0]),n[1]=i[1]+e*(t[1]-i[1]),n[2]=i[2]+e*(t[2]-i[2]),n}function oo(i,t,e,n){return n=n||new H(3),n[0]=i[0]+e[0]*(t[0]-i[0]),n[1]=i[1]+e[1]*(t[1]-i[1]),n[2]=i[2]+e[2]*(t[2]-i[2]),n}function ao(i,t,e){return e=e||new H(3),e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e[2]=Math.max(i[2],t[2]),e}function ho(i,t,e){return e=e||new H(3),e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e[2]=Math.min(i[2],t[2]),e}function co(i,t,e){return e=e||new H(3),e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e}function lo(i,t,e){return e=e||new H(3),e[0]=i[0]/t,e[1]=i[1]/t,e[2]=i[2]/t,e}function wn(i,t,e){e=e||new H(3);const n=i[2]*t[0]-i[0]*t[2],r=i[0]*t[1]-i[1]*t[0];return e[0]=i[1]*t[2]-i[2]*t[1],e[1]=n,e[2]=r,e}function uo(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]}function fo(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2])}function mo(i){return i[0]*i[0]+i[1]*i[1]+i[2]*i[2]}function po(i,t){const e=i[0]-t[0],n=i[1]-t[1],r=i[2]-t[2];return Math.sqrt(e*e+n*n+r*r)}function yo(i,t){const e=i[0]-t[0],n=i[1]-t[1],r=i[2]-t[2];return e*e+n*n+r*r}function Mi(i,t){t=t||new H(3);const e=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],n=Math.sqrt(e);return n>1e-5?(t[0]=i[0]/n,t[1]=i[1]/n,t[2]=i[2]/n):(t[0]=0,t[1]=0,t[2]=0),t}function xo(i,t){return t=t||new H(3),t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t}function _o(i,t){return t=t||new H(3),t[0]=i[0],t[1]=i[1],t[2]=i[2],t}function go(i,t,e){return e=e||new H(3),e[0]=i[0]*t[0],e[1]=i[1]*t[1],e[2]=i[2]*t[2],e}function bo(i,t,e){return e=e||new H(3),e[0]=i[0]/t[0],e[1]=i[1]/t[1],e[2]=i[2]/t[2],e}var Mo=Object.freeze({__proto__:null,add:ro,copy:_o,create:It,cross:wn,distance:po,distanceSq:yo,divide:bo,divScalar:lo,dot:uo,lerp:so,lerpV:oo,length:fo,lengthSq:mo,max:ao,min:ho,mulScalar:co,multiply:go,negate:xo,normalize:Mi,setDefaultType:no,subtract:Zr});let N=Float32Array;function Ao(i){const t=N;return N=i,t}function wo(i,t){return t=t||new N(16),t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t[3]=-i[3],t[4]=-i[4],t[5]=-i[5],t[6]=-i[6],t[7]=-i[7],t[8]=-i[8],t[9]=-i[9],t[10]=-i[10],t[11]=-i[11],t[12]=-i[12],t[13]=-i[13],t[14]=-i[14],t[15]=-i[15],t}function Eo(){return new N(16).fill(0)}function Jr(i,t){return t=t||new N(16),t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t}function Qr(i){return i=i||new N(16),i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function So(i,t){if(t=t||new N(16),t===i){let g;return g=i[1],i[1]=i[4],i[4]=g,g=i[2],i[2]=i[8],i[8]=g,g=i[3],i[3]=i[12],i[12]=g,g=i[6],i[6]=i[9],i[9]=g,g=i[7],i[7]=i[13],i[13]=g,g=i[11],i[11]=i[14],i[14]=g,t}const e=i[0*4+0],n=i[0*4+1],r=i[0*4+2],s=i[0*4+3],o=i[1*4+0],a=i[1*4+1],h=i[1*4+2],c=i[1*4+3],l=i[2*4+0],u=i[2*4+1],f=i[2*4+2],d=i[2*4+3],m=i[3*4+0],p=i[3*4+1],y=i[3*4+2],x=i[3*4+3];return t[0]=e,t[1]=o,t[2]=l,t[3]=m,t[4]=n,t[5]=a,t[6]=u,t[7]=p,t[8]=r,t[9]=h,t[10]=f,t[11]=y,t[12]=s,t[13]=c,t[14]=d,t[15]=x,t}function Kr(i,t){t=t||new N(16);const e=i[0*4+0],n=i[0*4+1],r=i[0*4+2],s=i[0*4+3],o=i[1*4+0],a=i[1*4+1],h=i[1*4+2],c=i[1*4+3],l=i[2*4+0],u=i[2*4+1],f=i[2*4+2],d=i[2*4+3],m=i[3*4+0],p=i[3*4+1],y=i[3*4+2],x=i[3*4+3],g=f*x,A=y*d,b=h*x,E=y*c,M=h*d,w=f*c,R=r*x,U=y*s,S=r*d,B=f*s,z=r*c,I=h*s,T=l*p,F=m*u,C=o*p,P=m*a,D=o*u,j=l*a,ft=e*p,dt=m*n,jt=e*u,re=l*n,Ct=e*a,tt=o*n,V=g*a+E*u+M*p-(A*a+b*u+w*p),it=A*n+R*u+B*p-(g*n+U*u+S*p),Kn=b*n+U*a+z*p-(E*n+R*a+I*p),tr=w*n+S*a+I*u-(M*n+B*a+z*u),$=1/(e*V+o*it+l*Kn+m*tr);return t[0]=$*V,t[1]=$*it,t[2]=$*Kn,t[3]=$*tr,t[4]=$*(A*o+b*l+w*m-(g*o+E*l+M*m)),t[5]=$*(g*e+U*l+S*m-(A*e+R*l+B*m)),t[6]=$*(E*e+R*o+I*m-(b*e+U*o+z*m)),t[7]=$*(M*e+B*o+z*l-(w*e+S*o+I*l)),t[8]=$*(T*c+P*d+D*x-(F*c+C*d+j*x)),t[9]=$*(F*s+ft*d+re*x-(T*s+dt*d+jt*x)),t[10]=$*(C*s+dt*c+Ct*x-(P*s+ft*c+tt*x)),t[11]=$*(j*s+jt*c+tt*d-(D*s+re*c+Ct*d)),t[12]=$*(C*f+j*y+F*h-(D*y+T*h+P*f)),t[13]=$*(jt*y+T*r+dt*f-(ft*f+re*y+F*r)),t[14]=$*(ft*h+tt*y+P*r-(Ct*y+C*r+dt*h)),t[15]=$*(Ct*f+D*r+re*h-(jt*h+tt*f+j*r)),t}function To(i,t,e){e=e||new N(16);const n=i[0],r=i[1],s=i[2],o=i[3],a=i[4+0],h=i[4+1],c=i[4+2],l=i[4+3],u=i[8+0],f=i[8+1],d=i[8+2],m=i[8+3],p=i[12+0],y=i[12+1],x=i[12+2],g=i[12+3],A=t[0],b=t[1],E=t[2],M=t[3],w=t[4+0],R=t[4+1],U=t[4+2],S=t[4+3],B=t[8+0],z=t[8+1],I=t[8+2],T=t[8+3],F=t[12+0],C=t[12+1],P=t[12+2],D=t[12+3];return e[0]=n*A+a*b+u*E+p*M,e[1]=r*A+h*b+f*E+y*M,e[2]=s*A+c*b+d*E+x*M,e[3]=o*A+l*b+m*E+g*M,e[4]=n*w+a*R+u*U+p*S,e[5]=r*w+h*R+f*U+y*S,e[6]=s*w+c*R+d*U+x*S,e[7]=o*w+l*R+m*U+g*S,e[8]=n*B+a*z+u*I+p*T,e[9]=r*B+h*z+f*I+y*T,e[10]=s*B+c*z+d*I+x*T,e[11]=o*B+l*z+m*I+g*T,e[12]=n*F+a*C+u*P+p*D,e[13]=r*F+h*C+f*P+y*D,e[14]=s*F+c*C+d*P+x*D,e[15]=o*F+l*C+m*P+g*D,e}function Fo(i,t,e){return e=e||Qr(),i!==e&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11]),e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function vo(i,t){return t=t||It(),t[0]=i[12],t[1]=i[13],t[2]=i[14],t}function Ro(i,t,e){e=e||It();const n=t*4;return e[0]=i[n+0],e[1]=i[n+1],e[2]=i[n+2],e}function zo(i,t,e,n){n!==i&&(n=Jr(i,n));const r=e*4;return n[r+0]=t[0],n[r+1]=t[1],n[r+2]=t[2],n}function Io(i,t,e,n,r){r=r||new N(16);const s=Math.tan(Math.PI*.5-.5*i),o=1/(e-n);return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(e+n)*o,r[11]=-1,r[12]=0,r[13]=0,r[14]=e*n*o*2,r[15]=0,r}function Bo(i,t,e,n,r,s,o){return o=o||new N(16),o[0]=2/(t-i),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(n-e),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2/(r-s),o[11]=0,o[12]=(t+i)/(i-t),o[13]=(n+e)/(e-n),o[14]=(s+r)/(r-s),o[15]=1,o}function Co(i,t,e,n,r,s,o){o=o||new N(16);const a=t-i,h=n-e,c=r-s;return o[0]=2*r/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r/h,o[6]=0,o[7]=0,o[8]=(i+t)/a,o[9]=(n+e)/h,o[10]=s/c,o[11]=-1,o[12]=0,o[13]=0,o[14]=r*s/c,o[15]=0,o}let Pt,$t,At;function Po(i,t,e,n){return n=n||new N(16),Pt=Pt||It(),$t=$t||It(),At=At||It(),Mi(Zr(i,t,At),At),Mi(wn(e,At,Pt),Pt),Mi(wn(At,Pt,$t),$t),n[0]=Pt[0],n[1]=Pt[1],n[2]=Pt[2],n[3]=0,n[4]=$t[0],n[5]=$t[1],n[6]=$t[2],n[7]=0,n[8]=At[0],n[9]=At[1],n[10]=At[2],n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}function Do(i,t){return t=t||new N(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function Lo(i,t,e){e=e||new N(16);const n=t[0],r=t[1],s=t[2],o=i[0],a=i[1],h=i[2],c=i[3],l=i[1*4+0],u=i[1*4+1],f=i[1*4+2],d=i[1*4+3],m=i[2*4+0],p=i[2*4+1],y=i[2*4+2],x=i[2*4+3],g=i[3*4+0],A=i[3*4+1],b=i[3*4+2],E=i[3*4+3];return i!==e&&(e[0]=o,e[1]=a,e[2]=h,e[3]=c,e[4]=l,e[5]=u,e[6]=f,e[7]=d,e[8]=m,e[9]=p,e[10]=y,e[11]=x),e[12]=o*n+l*r+m*s+g,e[13]=a*n+u*r+p*s+A,e[14]=h*n+f*r+y*s+b,e[15]=c*n+d*r+x*s+E,e}function No(i,t){t=t||new N(16);const e=Math.cos(i),n=Math.sin(i);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ko(i,t,e){e=e||new N(16);const n=i[4],r=i[5],s=i[6],o=i[7],a=i[8],h=i[9],c=i[10],l=i[11],u=Math.cos(t),f=Math.sin(t);return e[4]=u*n+f*a,e[5]=u*r+f*h,e[6]=u*s+f*c,e[7]=u*o+f*l,e[8]=u*a-f*n,e[9]=u*h-f*r,e[10]=u*c-f*s,e[11]=u*l-f*o,i!==e&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e}function Uo(i,t){t=t||new N(16);const e=Math.cos(i),n=Math.sin(i);return t[0]=e,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Oo(i,t,e){e=e||new N(16);const n=i[0*4+0],r=i[0*4+1],s=i[0*4+2],o=i[0*4+3],a=i[2*4+0],h=i[2*4+1],c=i[2*4+2],l=i[2*4+3],u=Math.cos(t),f=Math.sin(t);return e[0]=u*n-f*a,e[1]=u*r-f*h,e[2]=u*s-f*c,e[3]=u*o-f*l,e[8]=u*a+f*n,e[9]=u*h+f*r,e[10]=u*c+f*s,e[11]=u*l+f*o,i!==e&&(e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e}function Vo(i,t){t=t||new N(16);const e=Math.cos(i),n=Math.sin(i);return t[0]=e,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Go(i,t,e){e=e||new N(16);const n=i[0*4+0],r=i[0*4+1],s=i[0*4+2],o=i[0*4+3],a=i[1*4+0],h=i[1*4+1],c=i[1*4+2],l=i[1*4+3],u=Math.cos(t),f=Math.sin(t);return e[0]=u*n+f*a,e[1]=u*r+f*h,e[2]=u*s+f*c,e[3]=u*o+f*l,e[4]=u*a-f*n,e[5]=u*h-f*r,e[6]=u*c-f*s,e[7]=u*l-f*o,i!==e&&(e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e}function Wo(i,t,e){e=e||new N(16);let n=i[0],r=i[1],s=i[2];const o=Math.sqrt(n*n+r*r+s*s);n/=o,r/=o,s/=o;const a=n*n,h=r*r,c=s*s,l=Math.cos(t),u=Math.sin(t),f=1-l;return e[0]=a+(1-a)*l,e[1]=n*r*f+s*u,e[2]=n*s*f-r*u,e[3]=0,e[4]=n*r*f-s*u,e[5]=h+(1-h)*l,e[6]=r*s*f+n*u,e[7]=0,e[8]=n*s*f+r*u,e[9]=r*s*f-n*u,e[10]=c+(1-c)*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qo(i,t,e,n){n=n||new N(16);let r=t[0],s=t[1],o=t[2];const a=Math.sqrt(r*r+s*s+o*o);r/=a,s/=a,o/=a;const h=r*r,c=s*s,l=o*o,u=Math.cos(e),f=Math.sin(e),d=1-u,m=h+(1-h)*u,p=r*s*d+o*f,y=r*o*d-s*f,x=r*s*d-o*f,g=c+(1-c)*u,A=s*o*d+r*f,b=r*o*d+s*f,E=s*o*d-r*f,M=l+(1-l)*u,w=i[0],R=i[1],U=i[2],S=i[3],B=i[4],z=i[5],I=i[6],T=i[7],F=i[8],C=i[9],P=i[10],D=i[11];return n[0]=m*w+p*B+y*F,n[1]=m*R+p*z+y*C,n[2]=m*U+p*I+y*P,n[3]=m*S+p*T+y*D,n[4]=x*w+g*B+A*F,n[5]=x*R+g*z+A*C,n[6]=x*U+g*I+A*P,n[7]=x*S+g*T+A*D,n[8]=b*w+E*B+M*F,n[9]=b*R+E*z+M*C,n[10]=b*U+E*I+M*P,n[11]=b*S+E*T+M*D,i!==n&&(n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15]),n}function jo(i,t){return t=t||new N(16),t[0]=i[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=i[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ho(i,t,e){e=e||new N(16);const n=t[0],r=t[1],s=t[2];return e[0]=n*i[0*4+0],e[1]=n*i[0*4+1],e[2]=n*i[0*4+2],e[3]=n*i[0*4+3],e[4]=r*i[1*4+0],e[5]=r*i[1*4+1],e[6]=r*i[1*4+2],e[7]=r*i[1*4+3],e[8]=s*i[2*4+0],e[9]=s*i[2*4+1],e[10]=s*i[2*4+2],e[11]=s*i[2*4+3],i!==e&&(e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e}function $o(i,t,e){e=e||It();const n=t[0],r=t[1],s=t[2],o=n*i[0*4+3]+r*i[1*4+3]+s*i[2*4+3]+i[3*4+3];return e[0]=(n*i[0*4+0]+r*i[1*4+0]+s*i[2*4+0]+i[3*4+0])/o,e[1]=(n*i[0*4+1]+r*i[1*4+1]+s*i[2*4+1]+i[3*4+1])/o,e[2]=(n*i[0*4+2]+r*i[1*4+2]+s*i[2*4+2]+i[3*4+2])/o,e}function Xo(i,t,e){e=e||It();const n=t[0],r=t[1],s=t[2];return e[0]=n*i[0*4+0]+r*i[1*4+0]+s*i[2*4+0],e[1]=n*i[0*4+1]+r*i[1*4+1]+s*i[2*4+1],e[2]=n*i[0*4+2]+r*i[1*4+2]+s*i[2*4+2],e}function Yo(i,t,e){e=e||It();const n=Kr(i),r=t[0],s=t[1],o=t[2];return e[0]=r*n[0*4+0]+s*n[0*4+1]+o*n[0*4+2],e[1]=r*n[1*4+0]+s*n[1*4+1]+o*n[1*4+2],e[2]=r*n[2*4+0]+s*n[2*4+1]+o*n[2*4+2],e}var L=Object.freeze({__proto__:null,axisRotate:qo,axisRotation:Wo,copy:Jr,create:Eo,frustum:Co,getAxis:Ro,getTranslation:vo,identity:Qr,inverse:Kr,lookAt:Po,multiply:To,negate:wo,ortho:Bo,perspective:Io,rotateX:ko,rotateY:Oo,rotateZ:Go,rotationX:No,rotationY:Uo,rotationZ:Vo,scale:Ho,scaling:jo,setAxis:zo,setDefaultType:Ao,setTranslation:Fo,transformDirection:Xo,transformNormal:Yo,transformPoint:$o,translate:Lo,translation:Do,transpose:So});const In=5120,Le=5121,Bn=5122,Cn=5123,Pn=5124,Dn=5125,Ln=5126,Zo=32819,Jo=32820,Qo=33635,Ko=5131,ta=33640,ea=35899,ia=35902,na=36269,ra=34042,ts={};{const i=ts;i[In]=Int8Array,i[Le]=Uint8Array,i[Bn]=Int16Array,i[Cn]=Uint16Array,i[Pn]=Int32Array,i[Dn]=Uint32Array,i[Ln]=Float32Array,i[Zo]=Uint16Array,i[Jo]=Uint16Array,i[Qo]=Uint16Array,i[Ko]=Uint16Array,i[ta]=Uint32Array,i[ea]=Uint32Array,i[ia]=Uint32Array,i[na]=Uint32Array,i[ra]=Uint32Array}function Nn(i){if(i instanceof Int8Array)return In;if(i instanceof Uint8Array||i instanceof Uint8ClampedArray)return Le;if(i instanceof Int16Array)return Bn;if(i instanceof Uint16Array)return Cn;if(i instanceof Int32Array)return Pn;if(i instanceof Uint32Array)return Dn;if(i instanceof Float32Array)return Ln;throw new Error("unsupported typed array type")}function es(i){if(i===Int8Array)return In;if(i===Uint8Array||i===Uint8ClampedArray)return Le;if(i===Int16Array)return Bn;if(i===Uint16Array)return Cn;if(i===Int32Array)return Pn;if(i===Uint32Array)return Dn;if(i===Float32Array)return Ln;throw new Error("unsupported typed array type")}function is(i){const t=ts[i];if(!t)throw new Error("unknown gl type");return t}const Ei=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function ns(...i){console.error(...i)}function sa(...i){console.warn(...i)}const er=new Map;function kn(i,t){if(!i||typeof i!="object")return!1;let e=er.get(t);e||(e=new WeakMap,er.set(t,e));let n=e.get(i);if(n===void 0){const r=Object.prototype.toString.call(i);n=r.substring(8,r.length-1)===t,e.set(i,n)}return n}function oa(i,t){return typeof WebGLBuffer<"u"&&kn(t,"WebGLBuffer")}function rs(i,t){return typeof WebGLTexture<"u"&&kn(t,"WebGLTexture")}function aa(i,t){return typeof WebGLSampler<"u"&&kn(t,"WebGLSampler")}const ss=35044,Kt=34962,ha=34963,ca=34660,la=5120,ua=5121,fa=5122,da=5123,ma=5124,pa=5125,os=5126,as={attribPrefix:""};function ya(i,t,e,n,r){i.bindBuffer(t,e),i.bufferData(t,n,r||ss)}function hs(i,t,e,n){if(oa(i,t))return t;e=e||Kt;const r=i.createBuffer();return ya(i,e,r,t,n),r}function cs(i){return i==="indices"}function xa(i){return i===Int8Array||i===Uint8Array}function _a(i){return i.length?i:i.data}const ga=/coord|texture/i,ba=/color|colour/i;function Ma(i,t){let e;if(ga.test(i)?e=2:ba.test(i)?e=4:e=3,t%e>0)throw new Error(`Can not guess numComponents for attribute '${i}'. Tried ${e} but ${t} values is not evenly divisible by ${e}. You should specify it.`);return e}function Aa(i,t,e){return i.numComponents||i.size||Ma(t,e||_a(i).length)}function ls(i,t){if(Ei(i))return i;if(Ei(i.data))return i.data;Array.isArray(i)&&(i={data:i});let e=i.type?Un(i.type):void 0;return e||(cs(t)?e=Uint16Array:e=Float32Array),new e(i.data)}function wa(i){return typeof i=="number"?i:i?es(i):os}function Un(i){return typeof i=="number"?is(i):i||Float32Array}function Ea(i,t){return{buffer:t.buffer,numValues:2*3*4,type:wa(t.type),arrayType:Un(t.type)}}function Sa(i,t){const e=t.data||t,n=Un(t.type),r=e*n.BYTES_PER_ELEMENT,s=i.createBuffer();return i.bindBuffer(Kt,s),i.bufferData(Kt,r,t.drawType||ss),{buffer:s,numValues:e,type:es(n),arrayType:n}}function Ta(i,t,e){const n=ls(t,e);return{arrayType:n.constructor,buffer:hs(i,n,void 0,t.drawType),type:Nn(n),numValues:0}}function Fa(i,t){const e={};return Object.keys(t).forEach(function(n){if(!cs(n)){const r=t[n],s=r.attrib||r.name||r.attribName||as.attribPrefix+n;if(r.value){if(!Array.isArray(r.value)&&!Ei(r.value))throw new Error("array.value is not array or typedarray");e[s]={value:r.value}}else{let o;r.buffer&&r.buffer instanceof WebGLBuffer?o=Ea:typeof r=="number"||typeof r.data=="number"?o=Sa:o=Ta;const{buffer:a,type:h,numValues:c,arrayType:l}=o(i,r,n),u=r.normalize!==void 0?r.normalize:xa(l),f=Aa(r,n,c);e[s]={buffer:a,numComponents:f,type:h,normalize:u,stride:r.stride||0,offset:r.offset||0,divisor:r.divisor===void 0?void 0:r.divisor,drawType:r.drawType}}}}),i.bindBuffer(Kt,null),e}function va(i,t){return t===la||t===ua?1:t===fa||t===da?2:t===ma||t===pa||t===os?4:0}const Vi=["position","positions","a_position"];function Ra(i,t){let e,n;for(n=0;n<Vi.length&&(e=Vi[n],!(e in t||(e=as.attribPrefix+e,e in t)));++n);n===Vi.length&&(e=Object.keys(t)[0]);const r=t[e];if(!r.buffer)return 1;i.bindBuffer(Kt,r.buffer);const s=i.getBufferParameter(Kt,ca);i.bindBuffer(Kt,null);const o=va(i,r.type),a=s/o,h=r.numComponents||r.size,c=a/h;if(c%1!==0)throw new Error(`numComponents ${h} not correct for length ${length}`);return c}function je(i,t,e){const n=Fa(i,t),r=Object.assign({},e||{});r.attribs=Object.assign({},e?e.attribs:{},n);const s=t.indices;if(s){const o=ls(s,"indices");r.indices=hs(i,o,ha),r.numElements=o.length,r.elementType=Nn(o)}else r.numElements||(r.numElements=Ra(i,r.attribs));return r}function Ue(i){return!!i.texStorage2D}const Si=function(){const i={},t={};function e(n){const r=n.constructor.name;if(!i[r]){for(const s in n)if(typeof n[s]=="number"){const o=t[n[s]];t[n[s]]=o?`${o} | ${s}`:s}i[r]=!0}}return function(r,s){return e(r),t[s]||(typeof s=="number"?`0x${s.toString(16)}`:s)}}(),Vt={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Ne=Ei,us=function(){let i;return function(){return i=i||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),i}}(),ir=6406,bt=6407,O=6408,nr=6409,rr=6410,ve=6402,sr=34041,Ti=33071,za=9728,Ia=9729,Gt=3553,Ot=34067,ee=32879,ie=35866,On=34069,Ba=34070,Ca=34071,Pa=34072,Da=34073,La=34074,En=10241,Sn=10240,Fi=10242,vi=10243,or=32882,Na=33082,ka=33083,Ua=33084,Oa=33085,Vn=3317,fs=3314,ds=32878,ms=3316,ps=3315,ys=32877,Va=37443,Ga=37441,Wa=37440,qa=33321,ja=36756,Ha=33325,$a=33326,Xa=33330,Ya=33329,Za=33338,Ja=33337,Qa=33340,Ka=33339,th=33323,eh=36757,ih=33327,nh=33328,rh=33336,sh=33335,oh=33332,ah=33331,hh=33334,ch=33333,lh=32849,uh=35905,fh=36194,dh=36758,mh=35898,ph=35901,yh=34843,xh=34837,_h=36221,gh=36239,bh=36215,Mh=36233,Ah=36209,wh=36227,Eh=32856,Sh=35907,Th=36759,Fh=32855,vh=32854,Rh=32857,zh=34842,Ih=34836,Bh=36220,Ch=36238,Ph=36975,Dh=36214,Lh=36232,Nh=36226,kh=36208,Uh=33189,Oh=33190,Vh=36012,Gh=36013,Wh=35056,Dt=5120,k=5121,He=5122,se=5123,$e=5124,Xt=5125,X=5126,ar=32819,hr=32820,cr=33635,mt=5131,Re=36193,Gi=33640,qh=35899,jh=35902,Hh=36269,$h=34042,Xe=33319,oe=33320,Ye=6403,ae=36244,he=36248,Yt=36249;let Wi;function zi(i){if(!Wi){const t={};t[ir]={textureFormat:ir,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[k,mt,Re,X]},t[nr]={textureFormat:nr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[k,mt,Re,X]},t[rr]={textureFormat:rr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[k,mt,Re,X]},t[bt]={textureFormat:bt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[k,mt,Re,X,cr]},t[O]={textureFormat:O,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[k,mt,Re,X,ar,hr]},t[ve]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Xt,se]},t[qa]={textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[k]},t[ja]={textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[Dt]},t[Ha]={textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[X,mt]},t[$a]={textureFormat:Ye,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[X]},t[Xa]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[k]},t[Ya]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Dt]},t[oh]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[se]},t[ah]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[He]},t[hh]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Xt]},t[ch]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$e]},t[th]={textureFormat:Xe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[k]},t[eh]={textureFormat:Xe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[Dt]},t[ih]={textureFormat:Xe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[X,mt]},t[nh]={textureFormat:Xe,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[X]},t[rh]={textureFormat:oe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[k]},t[sh]={textureFormat:oe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Dt]},t[Za]={textureFormat:oe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[se]},t[Ja]={textureFormat:oe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[He]},t[Qa]={textureFormat:oe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Xt]},t[Ka]={textureFormat:oe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[$e]},t[lh]={textureFormat:bt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[k]},t[uh]={textureFormat:bt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[k]},t[fh]={textureFormat:bt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[k,cr]},t[dh]={textureFormat:bt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Dt]},t[mh]={textureFormat:bt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[X,mt,qh]},t[ph]={textureFormat:bt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[X,mt,jh]},t[yh]={textureFormat:bt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[X,mt]},t[xh]={textureFormat:bt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[X]},t[_h]={textureFormat:he,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[k]},t[gh]={textureFormat:he,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Dt]},t[bh]={textureFormat:he,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[se]},t[Mh]={textureFormat:he,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[He]},t[Ah]={textureFormat:he,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Xt]},t[wh]={textureFormat:he,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[$e]},t[Eh]={textureFormat:O,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[k]},t[Sh]={textureFormat:O,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[k]},t[Th]={textureFormat:O,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[Dt]},t[Fh]={textureFormat:O,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[k,hr,Gi]},t[vh]={textureFormat:O,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[k,ar]},t[Rh]={textureFormat:O,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Gi]},t[zh]={textureFormat:O,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[X,mt]},t[Ih]={textureFormat:O,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[X]},t[Bh]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[k]},t[Ch]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Dt]},t[Ph]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Gi]},t[Dh]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[se]},t[Lh]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[He]},t[Nh]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[$e]},t[kh]={textureFormat:Yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Xt]},t[Uh]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[se,Xt]},t[Oh]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Xt]},t[Vh]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[X]},t[Wh]={textureFormat:sr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$h]},t[Gh]={textureFormat:sr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Hh]},Object.keys(t).forEach(function(e){const n=t[e];n.bytesPerElementMap={},n.bytesPerElement.forEach(function(r,s){const o=n.type[s];n.bytesPerElementMap[o]=r})}),Wi=t}return Wi[i]}function Xh(i,t){const e=zi(i);if(!e)throw"unknown internal format";const n=e.bytesPerElementMap[t];if(n===void 0)throw"unknown internal format";return n}function Oe(i){const t=zi(i);if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function lr(i){return(i&i-1)===0}function Yh(i,t,e,n){if(!Ue(i))return lr(t)&&lr(e);const r=zi(n);if(!r)throw"unknown internal format";return r.colorRenderable&&r.textureFilterable}function Zh(i){const t=zi(i);if(!t)throw"unknown internal format";return t.textureFilterable}function Jh(i,t,e){return Ne(t)?Nn(t):e||k}function Ze(i,t,e,n,r){if(r%1!==0)throw"can't guess dimensions";if(!e&&!n){const s=Math.sqrt(r/(t===Ot?6:1));s%1===0?(e=s,n=s):(e=r,n=1)}else if(n){if(!e&&(e=r/n,e%1))throw"can't guess dimensions"}else if(n=r/e,n%1)throw"can't guess dimensions";return{width:e,height:n}}function Te(i,t){t.colorspaceConversion!==void 0&&i.pixelStorei(Va,t.colorspaceConversion),t.premultiplyAlpha!==void 0&&i.pixelStorei(Ga,t.premultiplyAlpha),t.flipY!==void 0&&i.pixelStorei(Wa,t.flipY)}function xs(i){i.pixelStorei(Vn,4),Ue(i)&&(i.pixelStorei(fs,0),i.pixelStorei(ds,0),i.pixelStorei(ms,0),i.pixelStorei(ps,0),i.pixelStorei(ys,0))}function Qh(i,t,e,n){n.minMag&&(e.call(i,t,En,n.minMag),e.call(i,t,Sn,n.minMag)),n.min&&e.call(i,t,En,n.min),n.mag&&e.call(i,t,Sn,n.mag),n.wrap&&(e.call(i,t,Fi,n.wrap),e.call(i,t,vi,n.wrap),(t===ee||aa(i,t))&&e.call(i,t,or,n.wrap)),n.wrapR&&e.call(i,t,or,n.wrapR),n.wrapS&&e.call(i,t,Fi,n.wrapS),n.wrapT&&e.call(i,t,vi,n.wrapT),n.minLod&&e.call(i,t,Na,n.minLod),n.maxLod&&e.call(i,t,ka,n.maxLod),n.baseLevel&&e.call(i,t,Ua,n.baseLevel),n.maxLevel&&e.call(i,t,Oa,n.maxLevel)}function _s(i,t,e){const n=e.target||Gt;i.bindTexture(n,t),Qh(i,n,i.texParameteri,e)}function Kh(i){return i=i||Vt.textureColor,Ne(i)?i:new Uint8Array([i[0]*255,i[1]*255,i[2]*255,i[3]*255])}function Tn(i,t,e,n,r,s){e=e||Vt.textureOptions,s=s||O;const o=e.target||Gt;if(n=n||e.width,r=r||e.height,i.bindTexture(o,t),Yh(i,n,r,s))i.generateMipmap(o);else{const a=Zh(s)?Ia:za;i.texParameteri(o,En,a),i.texParameteri(o,Sn,a),i.texParameteri(o,Fi,Ti),i.texParameteri(o,vi,Ti)}}function ke(i){return i.auto===!0||i.auto===void 0&&i.level===void 0}function Fn(i,t){return t=t||{},t.cubeFaceOrder||[On,Ba,Ca,Pa,Da,La]}function vn(i,t){const n=Fn(i,t).map(function(r,s){return{face:r,ndx:s}});return n.sort(function(r,s){return r.face-s.face}),n}function gs(i,t,e,n){n=n||Vt.textureOptions;const r=n.target||Gt,s=n.level||0;let o=e.width,a=e.height;const h=n.internalFormat||n.format||O,c=Oe(h),l=n.format||c.format,u=n.type||c.type;if(Te(i,n),i.bindTexture(r,t),r===Ot){const f=e.width,d=e.height;let m,p;if(f/6===d)m=d,p=[0,0,1,0,2,0,3,0,4,0,5,0];else if(d/6===f)m=f,p=[0,0,0,1,0,2,0,3,0,4,0,5];else if(f/3===d/2)m=f/3,p=[0,0,1,0,2,0,0,1,1,1,2,1];else if(f/2===d/3)m=f/2,p=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(e.src?e.src:e.nodeName);const y=us();y?(y.canvas.width=m,y.canvas.height=m,o=m,a=m,vn(i,n).forEach(function(x){const g=p[x.ndx*2+0]*m,A=p[x.ndx*2+1]*m;y.drawImage(e,g,A,m,m,0,0,m,m),i.texImage2D(x.face,s,h,l,u,y.canvas)}),y.canvas.width=1,y.canvas.height=1):typeof createImageBitmap<"u"&&(o=m,a=m,vn(i,n).forEach(function(x){const g=p[x.ndx*2+0]*m,A=p[x.ndx*2+1]*m;i.texImage2D(x.face,s,h,m,m,0,l,u,null),createImageBitmap(e,g,A,m,m,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(b){Te(i,n),i.bindTexture(r,t),i.texImage2D(x.face,s,h,l,u,b),ke(n)&&Tn(i,t,n,o,a,h)})}))}else if(r===ee||r===ie){const f=Math.min(e.width,e.height),d=Math.max(e.width,e.height),m=d/f;if(m%1!==0)throw"can not compute 3D dimensions of element";const p=e.width===d?1:0,y=e.height===d?1:0;i.pixelStorei(Vn,1),i.pixelStorei(fs,e.width),i.pixelStorei(ds,0),i.pixelStorei(ys,0),i.texImage3D(r,s,h,f,f,f,0,l,u,null);for(let x=0;x<m;++x){const g=x*f*p,A=x*f*y;i.pixelStorei(ms,g),i.pixelStorei(ps,A),i.texSubImage3D(r,s,0,0,x,f,f,1,l,u,e)}xs(i)}else i.texImage2D(r,s,h,l,u,e);ke(n)&&Tn(i,t,n,o,a,h),_s(i,t,n)}function Ve(){}function tc(i){if(typeof document<"u"){const t=document.createElement("a");return t.href=i,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}else{const t=new URL(location.href).origin;return new URL(i,location.href).origin===t}}function ec(i,t){return t===void 0&&!tc(i)?"anonymous":t}function ic(i,t,e){e=e||Ve;let n;if(t=t!==void 0?t:Vt.crossOrigin,t=ec(i,t),typeof Image<"u"){n=new Image,t!==void 0&&(n.crossOrigin=t);const r=function(){n.removeEventListener("error",s),n.removeEventListener("load",o),n=null},s=function(){const h="couldn't load image: "+i;ns(h),e(h,n),r()},o=function(){e(null,n),r()};return n.addEventListener("error",s),n.addEventListener("load",o),n.src=i,n}else if(typeof ImageBitmap<"u"){let r,s;const o=function(){e(r,s)},a={};t&&(a.mode="cors"),fetch(i,a).then(function(h){if(!h.ok)throw h;return h.blob()}).then(function(h){return createImageBitmap(h,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(h){s=h,setTimeout(o)}).catch(function(h){r=h,setTimeout(o)}),n=null}return n}function bs(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap||typeof ImageData<"u"&&i instanceof ImageData||typeof HTMLElement<"u"&&i instanceof HTMLElement}function Gn(i,t,e){return bs(i)?(setTimeout(function(){e(null,i)}),i):ic(i,t,e)}function Wn(i,t,e){e=e||Vt.textureOptions;const n=e.target||Gt;if(i.bindTexture(n,t),e.color===!1)return;const r=Kh(e.color);if(n===Ot)for(let s=0;s<6;++s)i.texImage2D(On+s,0,O,1,1,0,O,k,r);else n===ee||n===ie?i.texImage3D(n,0,O,1,1,1,0,O,k,r):i.texImage2D(n,0,O,1,1,0,O,k,r)}function nc(i,t,e,n){return n=n||Ve,e=e||Vt.textureOptions,Wn(i,t,e),e=Object.assign({},e),Gn(e.src,e.crossOrigin,function(s,o){s?n(s,t,o):(gs(i,t,o,e),n(null,t,o))})}function rc(i,t,e,n){n=n||Ve;const r=e.src;if(r.length!==6)throw"there must be 6 urls for a cubemap";const s=e.level||0,o=e.internalFormat||e.format||O,a=Oe(o),h=e.format||a.format,c=e.type||k,l=e.target||Gt;if(l!==Ot)throw"target must be TEXTURE_CUBE_MAP";Wn(i,t,e),e=Object.assign({},e);let u=6;const f=[],d=Fn(i,e);let m;function p(y){return function(x,g){--u,x?f.push(x):g.width!==g.height?f.push("cubemap face img is not a square: "+g.src):(Te(i,e),i.bindTexture(l,t),u===5?Fn().forEach(function(A){i.texImage2D(A,s,o,h,c,g)}):i.texImage2D(y,s,o,h,c,g),ke(e)&&i.generateMipmap(l)),u===0&&n(f.length?f:void 0,t,m)}}m=r.map(function(y,x){return Gn(y,e.crossOrigin,p(d[x]))})}function sc(i,t,e,n){n=n||Ve;const r=e.src,s=e.internalFormat||e.format||O,o=Oe(s),a=e.format||o.format,h=e.type||k,c=e.target||ie;if(c!==ee&&c!==ie)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Wn(i,t,e),e=Object.assign({},e);let l=r.length;const u=[];let f;const d=e.level||0;let m=e.width,p=e.height;const y=r.length;let x=!0;function g(A){return function(b,E){if(--l,b)u.push(b);else{if(Te(i,e),i.bindTexture(c,t),x){x=!1,m=e.width||E.width,p=e.height||E.height,i.texImage3D(c,d,s,m,p,y,0,a,h,null);for(let M=0;M<y;++M)i.texSubImage3D(c,d,0,0,M,m,p,1,a,h,E)}else{let M=E,w;(E.width!==m||E.height!==p)&&(w=us(),M=w.canvas,w.canvas.width=m,w.canvas.height=p,w.drawImage(E,0,0,m,p)),i.texSubImage3D(c,d,0,0,A,m,p,1,a,h,M),w&&M===w.canvas&&(w.canvas.width=0,w.canvas.height=0)}ke(e)&&i.generateMipmap(c)}l===0&&n(u.length?u:void 0,t,f)}}f=r.map(function(A,b){return Gn(A,e.crossOrigin,g(b))})}function oc(i,t,e,n){n=n||Vt.textureOptions;const r=n.target||Gt;i.bindTexture(r,t);let s=n.width,o=n.height,a=n.depth;const h=n.level||0,c=n.internalFormat||n.format||O,l=Oe(c),u=n.format||l.format,f=n.type||Jh(i,e,l.type);if(Ne(e))e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));else{const y=is(f);e=new y(e)}const d=Xh(c,f),m=e.byteLength/d;if(m%1)throw"length wrong size for format: "+Si(i,u);let p;if(r===ee||r===ie)if(!s&&!o&&!a){const y=Math.cbrt(m);if(y%1!==0)throw"can't guess cube size of array of numElements: "+m;s=y,o=y,a=y}else s&&(!o||!a)?(p=Ze(i,r,o,a,m/s),o=p.width,a=p.height):o&&(!s||!a)?(p=Ze(i,r,s,a,m/o),s=p.width,a=p.height):(p=Ze(i,r,s,o,m/a),s=p.width,o=p.height);else p=Ze(i,r,s,o,m),s=p.width,o=p.height;if(xs(i),i.pixelStorei(Vn,n.unpackAlignment||1),Te(i,n),r===Ot){const y=d/e.BYTES_PER_ELEMENT,x=m/6*y;vn(i,n).forEach(g=>{const A=x*g.ndx,b=e.subarray(A,A+x);i.texImage2D(g.face,h,c,s,o,0,u,f,b)})}else r===ee||r===ie?i.texImage3D(r,h,c,s,o,a,0,u,f,e):i.texImage2D(r,h,c,s,o,0,u,f,e);return{width:s,height:o,depth:a,type:f}}function ac(i,t,e){const n=e.target||Gt;i.bindTexture(n,t);const r=e.level||0,s=e.internalFormat||e.format||O,o=Oe(s),a=e.format||o.format,h=e.type||o.type;if(Te(i,e),n===Ot)for(let c=0;c<6;++c)i.texImage2D(On+c,r,s,e.width,e.height,0,a,h,null);else n===ee||n===ie?i.texImage3D(n,r,s,e.width,e.height,e.depth,0,a,h,null):i.texImage2D(n,r,s,e.width,e.height,0,a,h,null)}function qi(i,t,e){e=e||Ve,t=t||Vt.textureOptions;const n=i.createTexture(),r=t.target||Gt;let s=t.width||1,o=t.height||1;const a=t.internalFormat||O;i.bindTexture(r,n),r===Ot&&(i.texParameteri(r,Fi,Ti),i.texParameteri(r,vi,Ti));let h=t.src;if(h)if(typeof h=="function"&&(h=h(i,t)),typeof h=="string")nc(i,n,t,e);else if(Ne(h)||Array.isArray(h)&&(typeof h[0]=="number"||Array.isArray(h[0])||Ne(h[0]))){const c=oc(i,n,h,t);s=c.width,o=c.height}else Array.isArray(h)&&(typeof h[0]=="string"||bs(h[0]))?r===Ot?rc(i,n,t,e):sc(i,n,t,e):(gs(i,n,h,t),s=h.width,o=h.height);else ac(i,n,t);return ke(t)&&Tn(i,n,t,s,o,a),_s(i,n,t),n}const qn=ns;function Ms(i){return typeof document<"u"&&document.getElementById?document.getElementById(i):null}const Ri=33984,Ii=34962,hc=34963,cc=35713,lc=35714,uc=35632,fc=35633,dc=35981,As=35718,mc=35721,pc=35971,yc=35382,xc=35396,_c=35398,gc=35392,bc=35395,Bi=5126,ws=35664,Es=35665,Ss=35666,jn=5124,Ts=35667,Fs=35668,vs=35669,Rs=35670,zs=35671,Is=35672,Bs=35673,Cs=35674,Ps=35675,Ds=35676,Mc=35678,Ac=35680,wc=35679,Ec=35682,Sc=35685,Tc=35686,Fc=35687,vc=35688,Rc=35689,zc=35690,Ic=36289,Bc=36292,Cc=36293,Hn=5125,Ls=36294,Ns=36295,ks=36296,Pc=36298,Dc=36299,Lc=36300,Nc=36303,kc=36306,Uc=36307,Oc=36308,Vc=36311,Ci=3553,Pi=34067,$n=32879,Di=35866,v={};function Us(i,t){return v[t].bindPoint}function Gc(i,t){return function(e){i.uniform1f(t,e)}}function Wc(i,t){return function(e){i.uniform1fv(t,e)}}function qc(i,t){return function(e){i.uniform2fv(t,e)}}function jc(i,t){return function(e){i.uniform3fv(t,e)}}function Hc(i,t){return function(e){i.uniform4fv(t,e)}}function Os(i,t){return function(e){i.uniform1i(t,e)}}function Vs(i,t){return function(e){i.uniform1iv(t,e)}}function Gs(i,t){return function(e){i.uniform2iv(t,e)}}function Ws(i,t){return function(e){i.uniform3iv(t,e)}}function qs(i,t){return function(e){i.uniform4iv(t,e)}}function $c(i,t){return function(e){i.uniform1ui(t,e)}}function Xc(i,t){return function(e){i.uniform1uiv(t,e)}}function Yc(i,t){return function(e){i.uniform2uiv(t,e)}}function Zc(i,t){return function(e){i.uniform3uiv(t,e)}}function Jc(i,t){return function(e){i.uniform4uiv(t,e)}}function Qc(i,t){return function(e){i.uniformMatrix2fv(t,!1,e)}}function Kc(i,t){return function(e){i.uniformMatrix3fv(t,!1,e)}}function tl(i,t){return function(e){i.uniformMatrix4fv(t,!1,e)}}function el(i,t){return function(e){i.uniformMatrix2x3fv(t,!1,e)}}function il(i,t){return function(e){i.uniformMatrix3x2fv(t,!1,e)}}function nl(i,t){return function(e){i.uniformMatrix2x4fv(t,!1,e)}}function rl(i,t){return function(e){i.uniformMatrix4x2fv(t,!1,e)}}function sl(i,t){return function(e){i.uniformMatrix3x4fv(t,!1,e)}}function ol(i,t){return function(e){i.uniformMatrix4x3fv(t,!1,e)}}function Q(i,t,e,n){const r=Us(i,t);return Ue(i)?function(s){let o,a;!s||rs(i,s)?(o=s,a=null):(o=s.texture,a=s.sampler),i.uniform1i(n,e),i.activeTexture(Ri+e),i.bindTexture(r,o),i.bindSampler(e,a)}:function(s){i.uniform1i(n,e),i.activeTexture(Ri+e),i.bindTexture(r,s)}}function K(i,t,e,n,r){const s=Us(i,t),o=new Int32Array(r);for(let a=0;a<r;++a)o[a]=e+a;return Ue(i)?function(a){i.uniform1iv(n,o),a.forEach(function(h,c){i.activeTexture(Ri+o[c]);let l,u;!h||rs(i,h)?(l=h,u=null):(l=h.texture,u=h.sampler),i.bindSampler(e,u),i.bindTexture(s,l)})}:function(a){i.uniform1iv(n,o),a.forEach(function(h,c){i.activeTexture(Ri+o[c]),i.bindTexture(s,h)})}}v[Bi]={Type:Float32Array,size:4,setter:Gc,arraySetter:Wc};v[ws]={Type:Float32Array,size:8,setter:qc,cols:2};v[Es]={Type:Float32Array,size:12,setter:jc,cols:3};v[Ss]={Type:Float32Array,size:16,setter:Hc,cols:4};v[jn]={Type:Int32Array,size:4,setter:Os,arraySetter:Vs};v[Ts]={Type:Int32Array,size:8,setter:Gs,cols:2};v[Fs]={Type:Int32Array,size:12,setter:Ws,cols:3};v[vs]={Type:Int32Array,size:16,setter:qs,cols:4};v[Hn]={Type:Uint32Array,size:4,setter:$c,arraySetter:Xc};v[Ls]={Type:Uint32Array,size:8,setter:Yc,cols:2};v[Ns]={Type:Uint32Array,size:12,setter:Zc,cols:3};v[ks]={Type:Uint32Array,size:16,setter:Jc,cols:4};v[Rs]={Type:Uint32Array,size:4,setter:Os,arraySetter:Vs};v[zs]={Type:Uint32Array,size:8,setter:Gs,cols:2};v[Is]={Type:Uint32Array,size:12,setter:Ws,cols:3};v[Bs]={Type:Uint32Array,size:16,setter:qs,cols:4};v[Cs]={Type:Float32Array,size:32,setter:Qc,rows:2,cols:2};v[Ps]={Type:Float32Array,size:48,setter:Kc,rows:3,cols:3};v[Ds]={Type:Float32Array,size:64,setter:tl,rows:4,cols:4};v[Sc]={Type:Float32Array,size:32,setter:el,rows:2,cols:3};v[Tc]={Type:Float32Array,size:32,setter:nl,rows:2,cols:4};v[Fc]={Type:Float32Array,size:48,setter:il,rows:3,cols:2};v[vc]={Type:Float32Array,size:48,setter:sl,rows:3,cols:4};v[Rc]={Type:Float32Array,size:64,setter:rl,rows:4,cols:2};v[zc]={Type:Float32Array,size:64,setter:ol,rows:4,cols:3};v[Mc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Ci};v[Ac]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Pi};v[wc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:$n};v[Ec]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Ci};v[Ic]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Di};v[Bc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Di};v[Cc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Pi};v[Pc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Ci};v[Dc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:$n};v[Lc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Pi};v[Nc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Di};v[kc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Ci};v[Uc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:$n};v[Oc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Pi};v[Vc]={Type:null,size:0,setter:Q,arraySetter:K,bindPoint:Di};function Li(i,t){return function(e){if(e.value)switch(i.disableVertexAttribArray(t),e.value.length){case 4:i.vertexAttrib4fv(t,e.value);break;case 3:i.vertexAttrib3fv(t,e.value);break;case 2:i.vertexAttrib2fv(t,e.value);break;case 1:i.vertexAttrib1fv(t,e.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else i.bindBuffer(Ii,e.buffer),i.enableVertexAttribArray(t),i.vertexAttribPointer(t,e.numComponents||e.size,e.type||Bi,e.normalize||!1,e.stride||0,e.offset||0),i.vertexAttribDivisor&&i.vertexAttribDivisor(t,e.divisor||0)}}function Wt(i,t){return function(e){if(e.value)if(i.disableVertexAttribArray(t),e.value.length===4)i.vertexAttrib4iv(t,e.value);else throw new Error("The length of an integer constant value must be 4!");else i.bindBuffer(Ii,e.buffer),i.enableVertexAttribArray(t),i.vertexAttribIPointer(t,e.numComponents||e.size,e.type||jn,e.stride||0,e.offset||0),i.vertexAttribDivisor&&i.vertexAttribDivisor(t,e.divisor||0)}}function Ni(i,t){return function(e){if(e.value)if(i.disableVertexAttribArray(t),e.value.length===4)i.vertexAttrib4uiv(t,e.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else i.bindBuffer(Ii,e.buffer),i.enableVertexAttribArray(t),i.vertexAttribIPointer(t,e.numComponents||e.size,e.type||Hn,e.stride||0,e.offset||0),i.vertexAttribDivisor&&i.vertexAttribDivisor(t,e.divisor||0)}}function Xn(i,t,e){const n=e.size,r=e.count;return function(s){i.bindBuffer(Ii,s.buffer);const o=s.size||s.numComponents||n,a=o/r,h=s.type||Bi,l=v[h].size*o,u=s.normalize||!1,f=s.offset||0,d=l/r;for(let m=0;m<r;++m)i.enableVertexAttribArray(t+m),i.vertexAttribPointer(t+m,a,h,u,l,f+d*m),i.vertexAttribDivisor&&i.vertexAttribDivisor(t+m,s.divisor||0)}}const W={};W[Bi]={size:4,setter:Li};W[ws]={size:8,setter:Li};W[Es]={size:12,setter:Li};W[Ss]={size:16,setter:Li};W[jn]={size:4,setter:Wt};W[Ts]={size:8,setter:Wt};W[Fs]={size:12,setter:Wt};W[vs]={size:16,setter:Wt};W[Hn]={size:4,setter:Ni};W[Ls]={size:8,setter:Ni};W[Ns]={size:12,setter:Ni};W[ks]={size:16,setter:Ni};W[Rs]={size:4,setter:Wt};W[zs]={size:8,setter:Wt};W[Is]={size:12,setter:Wt};W[Bs]={size:16,setter:Wt};W[Cs]={size:4,setter:Xn,count:2};W[Ps]={size:9,setter:Xn,count:3};W[Ds]={size:16,setter:Xn,count:4};const al=/ERROR:\s*\d+:(\d+)/gi;function hl(i,t="",e=0){const n=[...t.matchAll(al)],r=new Map(n.map((s,o)=>{const a=parseInt(s[1]),h=n[o+1],c=h?h.index:t.length,l=t.substring(s.index,c);return[a-1,l]}));return i.split(`
`).map((s,o)=>{const a=r.get(o);return`${o+1+e}: ${s}${a?`

^^^ ${a}`:""}`}).join(`
`)}const ur=/^[ \t]*\n/;function js(i){let t=0;return ur.test(i)&&(t=1,i=i.replace(ur,"")),{lineOffset:t,shaderSource:i}}function cl(i,t){return i.errorCallback(t),i.callback&&setTimeout(()=>{i.callback(`${t}
${i.errors.join(`
`)}`)}),null}function ll(i,t,e,n){if(n=n||qn,!i.getShaderParameter(e,cc)){const s=i.getShaderInfoLog(e),{lineOffset:o,shaderSource:a}=js(i.getShaderSource(e)),h=`${hl(a,s,o)}
Error compiling ${Si(i,t)}: ${s}`;return n(h),h}return""}function Yn(i,t,e){let n,r,s;if(typeof t=="function"&&(e=t,t=void 0),typeof i=="function")e=i,i=void 0;else if(i&&!Array.isArray(i)){const c=i;e=c.errorCallback,i=c.attribLocations,n=c.transformFeedbackVaryings,r=c.transformFeedbackMode,s=c.callback}const o=e||qn,a=[],h={errorCallback(c,...l){a.push(c),o(c,...l)},transformFeedbackVaryings:n,transformFeedbackMode:r,callback:s,errors:a};{let c={};Array.isArray(i)?i.forEach(function(l,u){c[l]=t?t[u]:u}):c=i||{},h.attribLocations=c}return h}const ul=["VERTEX_SHADER","FRAGMENT_SHADER"];function fl(i,t){if(t.indexOf("frag")>=0)return uc;if(t.indexOf("vert")>=0)return fc}function dl(i,t,e){const n=i.getAttachedShaders(t);for(const r of n)e.has(r)&&i.deleteShader(r);i.deleteProgram(t)}const ml=(i=0)=>new Promise(t=>setTimeout(t,i));function pl(i,t,e){const n=i.createProgram(),{attribLocations:r,transformFeedbackVaryings:s,transformFeedbackMode:o}=Yn(e);for(let a=0;a<t.length;++a){let h=t[a];if(typeof h=="string"){const c=Ms(h),l=c?c.text:h;let u=i[ul[a]];c&&c.type&&(u=fl(i,c.type)||u),h=i.createShader(u),i.shaderSource(h,js(l).shaderSource),i.compileShader(h),i.attachShader(n,h)}}Object.entries(r).forEach(([a,h])=>i.bindAttribLocation(n,h,a));{let a=s;a&&(a.attribs&&(a=a.attribs),Array.isArray(a)||(a=Object.keys(a)),i.transformFeedbackVaryings(n,a,o||dc))}return i.linkProgram(n),n}function yl(i,t,e,n,r){const s=Yn(e,n,r),o=new Set(t),a=pl(i,t,s);function h(c,l){const u=_l(c,l,s.errorCallback);return u&&dl(c,l,o),u}if(s.callback){xl(i,a).then(()=>{const c=h(i,a);s.callback(c,c?void 0:a)});return}return h(i,a)?void 0:a}async function xl(i,t){const e=i.getExtension("KHR_parallel_shader_compile"),n=e?(s,o)=>s.getProgramParameter(o,e.COMPLETION_STATUS_KHR):()=>!0;let r=0;do await ml(r),r=1e3/60;while(!n(i,t))}function _l(i,t,e){if(e=e||qn,!i.getProgramParameter(t,lc)){const r=i.getProgramInfoLog(t);e(`Error in program linking: ${r}`);const o=i.getAttachedShaders(t).map(a=>ll(i,i.getShaderParameter(a,i.SHADER_TYPE),a,e));return`${r}
${o.filter(a=>a).join(`
`)}`}}function gl(i,t,e,n,r){return yl(i,t,e,n,r)}function Hs(i){const t=i.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const bl=/(\.|\[|]|\w+)/g,Ml=i=>i>="0"&&i<="9";function Al(i,t,e,n){const r=i.split(bl).filter(a=>a!=="");let s=0,o="";for(;;){const a=r[s++];o+=a;const h=Ml(a[0]),c=h?parseInt(a):a;if(h&&(o+=r[s++]),s===r.length){e[c]=t;break}else{const u=r[s++],f=u==="[",d=e[c]||(f?[]:{});e[c]=d,e=d,n[o]=n[o]||function(m){return function(p){$s(m,p)}}(d),o+=u}}}function wl(i,t){let e=0;function n(a,h,c){const l=h.name.endsWith("[0]"),u=h.type,f=v[u];if(!f)throw new Error(`unknown type: 0x${u.toString(16)}`);let d;if(f.bindPoint){const m=e;e+=h.size,l?d=f.arraySetter(i,u,m,c,h.size):d=f.setter(i,u,m,c,h.size)}else f.arraySetter&&l?d=f.arraySetter(i,c):d=f.setter(i,c);return d.location=c,d}const r={},s={},o=i.getProgramParameter(t,As);for(let a=0;a<o;++a){const h=i.getActiveUniform(t,a);if(Hs(h))continue;let c=h.name;c.endsWith("[0]")&&(c=c.substr(0,c.length-3));const l=i.getUniformLocation(t,h.name);if(l){const u=n(t,h,l);r[c]=u,Al(c,u,s,r)}}return r}function El(i,t){const e={},n=i.getProgramParameter(t,pc);for(let r=0;r<n;++r){const s=i.getTransformFeedbackVarying(t,r);e[s.name]={index:r,type:s.type,size:s.size}}return e}function Sl(i,t){const e=i.getProgramParameter(t,As),n=[],r=[];for(let a=0;a<e;++a){r.push(a),n.push({});const h=i.getActiveUniform(t,a);n[a].name=h.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){const h=a[0],c=a[1];i.getActiveUniforms(t,r,i[h]).forEach(function(l,u){n[u][c]=l})});const s={},o=i.getProgramParameter(t,yc);for(let a=0;a<o;++a){const h=i.getActiveUniformBlockName(t,a),c={index:i.getUniformBlockIndex(t,h),usedByVertexShader:i.getActiveUniformBlockParameter(t,a,xc),usedByFragmentShader:i.getActiveUniformBlockParameter(t,a,_c),size:i.getActiveUniformBlockParameter(t,a,gc),uniformIndices:i.getActiveUniformBlockParameter(t,a,bc)};c.used=c.usedByVertexShader||c.usedByFragmentShader,s[h]=c}return{blockSpecs:s,uniformData:n}}function $s(i,t){for(const e in t){const n=i[e];typeof n=="function"?n(t[e]):$s(i[e],t[e])}}function Ai(i,...t){const e=i.uniformSetters||i,n=t.length;for(let r=0;r<n;++r){const s=t[r];if(Array.isArray(s)){const o=s.length;for(let a=0;a<o;++a)Ai(e,s[a])}else for(const o in s){const a=e[o];a&&a(s[o])}}}function Tl(i,t){const e={},n=i.getProgramParameter(t,mc);for(let r=0;r<n;++r){const s=i.getActiveAttrib(t,r);if(Hs(s))continue;const o=i.getAttribLocation(t,s.name),a=W[s.type],h=a.setter(i,o,a);h.location=o,e[s.name]=h}return e}function Fl(i,t){for(const e in t){const n=i[e];n&&n(t[e])}}function ji(i,t,e){e.vertexArrayObject?i.bindVertexArray(e.vertexArrayObject):(Fl(t.attribSetters||t,e.attribs),e.indices&&i.bindBuffer(hc,e.indices))}function fr(i,t){const e=wl(i,t),n=Tl(i,t),r={program:t,uniformSetters:e,attribSetters:n};return Ue(i)&&(r.uniformBlockSpec=Sl(i,t),r.transformFeedbackInfo=El(i,t)),r}const vl=/\s|{|}|;/;function Hi(i,t,e,n,r){const s=Yn(e,n,r),o=[];if(t=t.map(function(c){if(!vl.test(c)){const l=Ms(c);if(l)c=l.text;else{const u=`no element with id: ${c}`;s.errorCallback(u),o.push(u)}}return c}),o.length)return cl(s,"");const a=s.callback;a&&(s.callback=(c,l)=>{a(c,c?void 0:fr(i,l))});const h=gl(i,t,s);return h?fr(i,h):null}const Rl=4,dr=5123;function $i(i,t,e,n,r,s){e=e===void 0?Rl:e;const o=t.indices,a=t.elementType,h=n===void 0?t.numElements:n;r=r===void 0?0:r,a||o?s!==void 0?i.drawElementsInstanced(e,h,a===void 0?dr:t.elementType,r,s):i.drawElements(e,h,a===void 0?dr:t.elementType,r):s!==void 0?i.drawArraysInstanced(e,r,h,s):i.drawArrays(e,r,h)}const zl=/^(.*?)_/;function Il(i,t){Si(i,0);const e=i.getExtension(t);if(e){const n={},r=zl.exec(t)[1],s="_"+r;for(const o in e){const a=e[o],h=typeof a=="function",c=h?r:s;let l=o;o.endsWith(c)&&(l=o.substring(0,o.length-c.length)),i[l]!==void 0?!h&&i[l]!==a&&sa(l,i[l],a,o):h?i[l]=function(u){return function(){return u.apply(e,arguments)}}(a):(i[l]=a,n[l]=a)}n.constructor={name:e.constructor.name},Si(n,0)}return e}const mr=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function Bl(i){for(let t=0;t<mr.length;++t)Il(i,mr[t])}function Cl(i,t){const e=["webgl2","webgl","experimental-webgl"];let n=null;for(let r=0;r<e.length;++r)if(n=i.getContext(e[r],t),n){Bl(n);break}return n}function Pl(i,t){return Cl(i,t)}function Dl(i,t){t=t||1,t=Math.max(0,t);const e=i.clientWidth*t|0,n=i.clientHeight*t|0;return i.width!==e||i.height!==n?(i.width=e,i.height=n,!0):!1}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Xs="154",Rn=0,Ll=1,pr=1,Nl=100,kl=204,Ul=205,Ol=3,Ys=0,Zs=300,yr=1e3,Je=1001,xr=1002,Vl=1006,Gl=1008,Wl=1009,ql=1015,jl=1023,Hl=3e3,Xi=3001,$l=0,Yi="",lt="srgb",Zn="srgb-linear",Js="display-p3",Zi=7680,Xl=519,_r=35044,Qe=2e3,gr=2001;class ki{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const r=this._listeners[t];if(r!==void 0){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,t);t.target=null}}}const Y=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Ge(){const i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Y[i&255]+Y[i>>8&255]+Y[i>>16&255]+Y[i>>24&255]+"-"+Y[t&255]+Y[t>>8&255]+"-"+Y[t>>16&15|64]+Y[t>>24&255]+"-"+Y[e&63|128]+Y[e>>8&255]+"-"+Y[e>>16&255]+Y[e>>24&255]+Y[n&255]+Y[n>>8&255]+Y[n>>16&255]+Y[n>>24&255]).toLowerCase()}function et(i,t,e){return Math.max(t,Math.min(e,i))}function Yl(i,t){return(i%t+t)%t}function Ji(i,t,e){return(1-e)*i+e*t}function Ke(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function nt(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}class J{constructor(t=0,e=0){J.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(et(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*n-o*r+t.x,this.y=s*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class qt{constructor(t,e,n,r,s,o,a,h,c){qt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,n,r,s,o,a,h,c)}set(t,e,n,r,s,o,a,h,c){const l=this.elements;return l[0]=t,l[1]=r,l[2]=a,l[3]=e,l[4]=s,l[5]=h,l[6]=n,l[7]=o,l[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,o=n[0],a=n[3],h=n[6],c=n[1],l=n[4],u=n[7],f=n[2],d=n[5],m=n[8],p=r[0],y=r[3],x=r[6],g=r[1],A=r[4],b=r[7],E=r[2],M=r[5],w=r[8];return s[0]=o*p+a*g+h*E,s[3]=o*y+a*A+h*M,s[6]=o*x+a*b+h*w,s[1]=c*p+l*g+u*E,s[4]=c*y+l*A+u*M,s[7]=c*x+l*b+u*w,s[2]=f*p+d*g+m*E,s[5]=f*y+d*A+m*M,s[8]=f*x+d*b+m*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8];return e*o*l-e*a*c-n*s*l+n*a*h+r*s*c-r*o*h}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],u=l*o-a*c,f=a*h-l*s,d=c*s-o*h,m=e*u+n*f+r*d;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return t[0]=u*p,t[1]=(r*c-l*n)*p,t[2]=(a*n-r*o)*p,t[3]=f*p,t[4]=(l*e-r*h)*p,t[5]=(r*s-a*e)*p,t[6]=d*p,t[7]=(n*h-c*e)*p,t[8]=(o*e-n*s)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,s,o,a){const h=Math.cos(s),c=Math.sin(s);return this.set(n*h,n*c,-n*(h*o+c*a)+o+t,-r*c,r*h,-r*(-c*o+h*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(Qi.makeScale(t,e)),this}rotate(t){return this.premultiply(Qi.makeRotation(-t)),this}translate(t,e){return this.premultiply(Qi.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const Qi=new qt;function Zl(i){for(let t=i.length-1;t>=0;--t)if(i[t]>=65535)return!0;return!1}function br(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const Mr={};function Ki(i){i in Mr||(Mr[i]=!0,console.warn(i))}function Ee(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function tn(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const Jl=new qt().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Ql=new qt().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function Kl(i){return i.convertSRGBToLinear().applyMatrix3(Ql)}function tu(i){return i.applyMatrix3(Jl).convertLinearToSRGB()}const eu={[Zn]:i=>i,[lt]:i=>i.convertSRGBToLinear(),[Js]:Kl},iu={[Zn]:i=>i,[lt]:i=>i.convertLinearToSRGB(),[Js]:tu},pt={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return Zn},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,t,e){if(this.enabled===!1||t===e||!t||!e)return i;const n=eu[t],r=iu[e];if(n===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${t}" to "${e}".`);return r(n(i))},fromWorkingColorSpace:function(i,t){return this.convert(i,this.workingColorSpace,t)},toWorkingColorSpace:function(i,t){return this.convert(i,t,this.workingColorSpace)}};let ce;class nu{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{ce===void 0&&(ce=br("canvas")),ce.width=t.width,ce.height=t.height;const n=ce.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=ce}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=br("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Ee(s[o]/255)*255;return n.putImageData(r,0,0),e}else if(t.data){const e=t.data.slice(0);for(let n=0;n<e.length;n++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[n]=Math.floor(Ee(e[n]/255)*255):e[n]=Ee(e[n]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let ru=0;class su{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ru++}),this.uuid=Ge(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(en(r[o].image)):s.push(en(r[o]))}else s=en(r);n.url=s}return e||(t.images[this.uuid]=n),n}}function en(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?nu.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ou=0;class te extends ki{constructor(t=te.DEFAULT_IMAGE,e=te.DEFAULT_MAPPING,n=Je,r=Je,s=Vl,o=Gl,a=jl,h=Wl,c=te.DEFAULT_ANISOTROPY,l=Yi){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ou++}),this.uuid=Ge(),this.name="",this.source=new su(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=h,this.offset=new J(0,0),this.repeat=new J(1,1),this.center=new J(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof l=="string"?this.colorSpace=l:(Ki("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=l===Xi?lt:Yi),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Zs)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case yr:t.x=t.x-Math.floor(t.x);break;case Je:t.x=t.x<0?0:1;break;case xr:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case yr:t.y=t.y-Math.floor(t.y);break;case Je:t.y=t.y<0?0:1;break;case xr:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Ki("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===lt?Xi:Hl}set encoding(t){Ki("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Xi?lt:Yi}}te.DEFAULT_IMAGE=null;te.DEFAULT_MAPPING=Zs;te.DEFAULT_ANISOTROPY=1;class We{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,s,o,a){let h=n[r+0],c=n[r+1],l=n[r+2],u=n[r+3];const f=s[o+0],d=s[o+1],m=s[o+2],p=s[o+3];if(a===0){t[e+0]=h,t[e+1]=c,t[e+2]=l,t[e+3]=u;return}if(a===1){t[e+0]=f,t[e+1]=d,t[e+2]=m,t[e+3]=p;return}if(u!==p||h!==f||c!==d||l!==m){let y=1-a;const x=h*f+c*d+l*m+u*p,g=x>=0?1:-1,A=1-x*x;if(A>Number.EPSILON){const E=Math.sqrt(A),M=Math.atan2(E,x*g);y=Math.sin(y*M)/E,a=Math.sin(a*M)/E}const b=a*g;if(h=h*y+f*b,c=c*y+d*b,l=l*y+m*b,u=u*y+p*b,y===1-a){const E=1/Math.sqrt(h*h+c*c+l*l+u*u);h*=E,c*=E,l*=E,u*=E}}t[e]=h,t[e+1]=c,t[e+2]=l,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,s,o){const a=n[r],h=n[r+1],c=n[r+2],l=n[r+3],u=s[o],f=s[o+1],d=s[o+2],m=s[o+3];return t[e]=a*m+l*u+h*d-c*f,t[e+1]=h*m+l*f+c*u-a*d,t[e+2]=c*m+l*d+a*f-h*u,t[e+3]=l*m-a*u-h*f-c*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const n=t._x,r=t._y,s=t._z,o=t._order,a=Math.cos,h=Math.sin,c=a(n/2),l=a(r/2),u=a(s/2),f=h(n/2),d=h(r/2),m=h(s/2);switch(o){case"XYZ":this._x=f*l*u+c*d*m,this._y=c*d*u-f*l*m,this._z=c*l*m+f*d*u,this._w=c*l*u-f*d*m;break;case"YXZ":this._x=f*l*u+c*d*m,this._y=c*d*u-f*l*m,this._z=c*l*m-f*d*u,this._w=c*l*u+f*d*m;break;case"ZXY":this._x=f*l*u-c*d*m,this._y=c*d*u+f*l*m,this._z=c*l*m+f*d*u,this._w=c*l*u-f*d*m;break;case"ZYX":this._x=f*l*u-c*d*m,this._y=c*d*u+f*l*m,this._z=c*l*m-f*d*u,this._w=c*l*u+f*d*m;break;case"YZX":this._x=f*l*u+c*d*m,this._y=c*d*u+f*l*m,this._z=c*l*m-f*d*u,this._w=c*l*u-f*d*m;break;case"XZY":this._x=f*l*u-c*d*m,this._y=c*d*u-f*l*m,this._z=c*l*m+f*d*u,this._w=c*l*u+f*d*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],s=e[8],o=e[1],a=e[5],h=e[9],c=e[2],l=e[6],u=e[10],f=n+a+u;if(f>0){const d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(l-h)*d,this._y=(s-c)*d,this._z=(o-r)*d}else if(n>a&&n>u){const d=2*Math.sqrt(1+n-a-u);this._w=(l-h)/d,this._x=.25*d,this._y=(r+o)/d,this._z=(s+c)/d}else if(a>u){const d=2*Math.sqrt(1+a-n-u);this._w=(s-c)/d,this._x=(r+o)/d,this._y=.25*d,this._z=(h+l)/d}else{const d=2*Math.sqrt(1+u-n-a);this._w=(o-r)/d,this._x=(s+c)/d,this._y=(h+l)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(et(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,s=t._z,o=t._w,a=e._x,h=e._y,c=e._z,l=e._w;return this._x=n*l+o*a+r*c-s*h,this._y=r*l+o*h+s*a-n*c,this._z=s*l+o*c+n*h-r*a,this._w=o*l-n*a-r*h-s*c,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+s*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const h=1-a*a;if(h<=Number.EPSILON){const d=1-e;return this._w=d*o+e*this._w,this._x=d*n+e*this._x,this._y=d*r+e*this._y,this._z=d*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(h),l=Math.atan2(c,a),u=Math.sin((1-e)*l)/c,f=Math.sin(e*l)/c;return this._w=o*u+this._w*f,this._x=n*u+this._x*f,this._y=r*u+this._y*f,this._z=s*u+this._z*f,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(s),n*Math.cos(s),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class _{constructor(t=0,e=0,n=0){_.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(Ar.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Ar.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6]*r,this.y=s[1]*e+s[4]*n+s[7]*r,this.z=s[2]*e+s[5]*n+s[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=t.elements,o=1/(s[3]*e+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*e+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*e+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*e+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,s=t.x,o=t.y,a=t.z,h=t.w,c=h*e+o*r-a*n,l=h*n+a*e-s*r,u=h*r+s*n-o*e,f=-s*e-o*n-a*r;return this.x=c*h+f*-s+l*-a-u*-o,this.y=l*h+f*-o+u*-s-c*-a,this.z=u*h+f*-a+c*-o-l*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r,this.y=s[1]*e+s[5]*n+s[9]*r,this.z=s[2]*e+s[6]*n+s[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,s=t.z,o=e.x,a=e.y,h=e.z;return this.x=r*h-s*a,this.y=s*o-n*h,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return nn.copy(this).projectOnVector(t),this.sub(nn)}reflect(t){return this.sub(nn.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(et(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const nn=new _,Ar=new We;class qe{constructor(t=new _(1/0,1/0,1/0),e=new _(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(Et.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(Et.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Et.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){if(t.updateWorldMatrix(!1,!1),t.boundingBox!==void 0)t.boundingBox===null&&t.computeBoundingBox(),le.copy(t.boundingBox),le.applyMatrix4(t.matrixWorld),this.union(le);else{const r=t.geometry;if(r!==void 0)if(e&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Et.fromBufferAttribute(s,o).applyMatrix4(t.matrixWorld),this.expandByPoint(Et)}else r.boundingBox===null&&r.computeBoundingBox(),le.copy(r.boundingBox),le.applyMatrix4(t.matrixWorld),this.union(le)}const n=t.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Et),Et.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(ze),ti.subVectors(this.max,ze),ue.subVectors(t.a,ze),fe.subVectors(t.b,ze),de.subVectors(t.c,ze),Lt.subVectors(fe,ue),Nt.subVectors(de,fe),Zt.subVectors(ue,de);let e=[0,-Lt.z,Lt.y,0,-Nt.z,Nt.y,0,-Zt.z,Zt.y,Lt.z,0,-Lt.x,Nt.z,0,-Nt.x,Zt.z,0,-Zt.x,-Lt.y,Lt.x,0,-Nt.y,Nt.x,0,-Zt.y,Zt.x,0];return!rn(e,ue,fe,de,ti)||(e=[1,0,0,0,1,0,0,0,1],!rn(e,ue,fe,de,ti))?!1:(ei.crossVectors(Lt,Nt),e=[ei.x,ei.y,ei.z],rn(e,ue,fe,de,ti))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Et).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(Et).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(wt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),wt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),wt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),wt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),wt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),wt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),wt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),wt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(wt),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const wt=[new _,new _,new _,new _,new _,new _,new _,new _],Et=new _,le=new qe,ue=new _,fe=new _,de=new _,Lt=new _,Nt=new _,Zt=new _,ze=new _,ti=new _,ei=new _,Jt=new _;function rn(i,t,e,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Jt.fromArray(i,s);const a=r.x*Math.abs(Jt.x)+r.y*Math.abs(Jt.y)+r.z*Math.abs(Jt.z),h=t.dot(Jt),c=e.dot(Jt),l=n.dot(Jt);if(Math.max(-Math.max(h,c,l),Math.min(h,c,l))>a)return!1}return!0}const au=new qe,Ie=new _,sn=new _;class Ui{constructor(t=new _,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):au.setFromPoints(t).getCenter(n);let r=0;for(let s=0,o=t.length;s<o;s++)r=Math.max(r,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Ie.subVectors(t,this.center);const e=Ie.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=(n-this.radius)*.5;this.center.addScaledVector(Ie,r/n),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(sn.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Ie.copy(t.center).add(sn)),this.expandByPoint(Ie.copy(t.center).sub(sn))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const St=new _,on=new _,ii=new _,kt=new _,an=new _,ni=new _,hn=new _;class Jn{constructor(t=new _,e=new _(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,St)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=St.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(St.copy(this.origin).addScaledVector(this.direction,e),St.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){on.copy(t).add(e).multiplyScalar(.5),ii.copy(e).sub(t).normalize(),kt.copy(this.origin).sub(on);const s=t.distanceTo(e)*.5,o=-this.direction.dot(ii),a=kt.dot(this.direction),h=-kt.dot(ii),c=kt.lengthSq(),l=Math.abs(1-o*o);let u,f,d,m;if(l>0)if(u=o*h-a,f=o*a-h,m=s*l,u>=0)if(f>=-m)if(f<=m){const p=1/l;u*=p,f*=p,d=u*(u+o*f+2*a)+f*(o*u+f+2*h)+c}else f=s,u=Math.max(0,-(o*f+a)),d=-u*u+f*(f+2*h)+c;else f=-s,u=Math.max(0,-(o*f+a)),d=-u*u+f*(f+2*h)+c;else f<=-m?(u=Math.max(0,-(-o*s+a)),f=u>0?-s:Math.min(Math.max(-s,-h),s),d=-u*u+f*(f+2*h)+c):f<=m?(u=0,f=Math.min(Math.max(-s,-h),s),d=f*(f+2*h)+c):(u=Math.max(0,-(o*s+a)),f=u>0?s:Math.min(Math.max(-s,-h),s),d=-u*u+f*(f+2*h)+c);else f=o>0?-s:s,u=Math.max(0,-(o*f+a)),d=-u*u+f*(f+2*h)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(on).addScaledVector(ii,f),d}intersectSphere(t,e){St.subVectors(t.center,this.origin);const n=St.dot(this.direction),r=St.dot(St)-n*n,s=t.radius*t.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,h=n+o;return h<0?null:a<0?this.at(h,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,s,o,a,h;const c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,f=this.origin;return c>=0?(n=(t.min.x-f.x)*c,r=(t.max.x-f.x)*c):(n=(t.max.x-f.x)*c,r=(t.min.x-f.x)*c),l>=0?(s=(t.min.y-f.y)*l,o=(t.max.y-f.y)*l):(s=(t.max.y-f.y)*l,o=(t.min.y-f.y)*l),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(t.min.z-f.z)*u,h=(t.max.z-f.z)*u):(a=(t.max.z-f.z)*u,h=(t.min.z-f.z)*u),n>h||a>r)||((a>n||n!==n)&&(n=a),(h<r||r!==r)&&(r=h),r<0)?null:this.at(n>=0?n:r,e)}intersectsBox(t){return this.intersectBox(t,St)!==null}intersectTriangle(t,e,n,r,s){an.subVectors(e,t),ni.subVectors(n,t),hn.crossVectors(an,ni);let o=this.direction.dot(hn),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;kt.subVectors(this.origin,t);const h=a*this.direction.dot(ni.crossVectors(kt,ni));if(h<0)return null;const c=a*this.direction.dot(an.cross(kt));if(c<0||h+c>o)return null;const l=-a*kt.dot(hn);return l<0?null:this.at(l/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ot{constructor(t,e,n,r,s,o,a,h,c,l,u,f,d,m,p,y){ot.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,n,r,s,o,a,h,c,l,u,f,d,m,p,y)}set(t,e,n,r,s,o,a,h,c,l,u,f,d,m,p,y){const x=this.elements;return x[0]=t,x[4]=e,x[8]=n,x[12]=r,x[1]=s,x[5]=o,x[9]=a,x[13]=h,x[2]=c,x[6]=l,x[10]=u,x[14]=f,x[3]=d,x[7]=m,x[11]=p,x[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ot().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/me.setFromMatrixColumn(t,0).length(),s=1/me.setFromMatrixColumn(t,1).length(),o=1/me.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,s=t.z,o=Math.cos(n),a=Math.sin(n),h=Math.cos(r),c=Math.sin(r),l=Math.cos(s),u=Math.sin(s);if(t.order==="XYZ"){const f=o*l,d=o*u,m=a*l,p=a*u;e[0]=h*l,e[4]=-h*u,e[8]=c,e[1]=d+m*c,e[5]=f-p*c,e[9]=-a*h,e[2]=p-f*c,e[6]=m+d*c,e[10]=o*h}else if(t.order==="YXZ"){const f=h*l,d=h*u,m=c*l,p=c*u;e[0]=f+p*a,e[4]=m*a-d,e[8]=o*c,e[1]=o*u,e[5]=o*l,e[9]=-a,e[2]=d*a-m,e[6]=p+f*a,e[10]=o*h}else if(t.order==="ZXY"){const f=h*l,d=h*u,m=c*l,p=c*u;e[0]=f-p*a,e[4]=-o*u,e[8]=m+d*a,e[1]=d+m*a,e[5]=o*l,e[9]=p-f*a,e[2]=-o*c,e[6]=a,e[10]=o*h}else if(t.order==="ZYX"){const f=o*l,d=o*u,m=a*l,p=a*u;e[0]=h*l,e[4]=m*c-d,e[8]=f*c+p,e[1]=h*u,e[5]=p*c+f,e[9]=d*c-m,e[2]=-c,e[6]=a*h,e[10]=o*h}else if(t.order==="YZX"){const f=o*h,d=o*c,m=a*h,p=a*c;e[0]=h*l,e[4]=p-f*u,e[8]=m*u+d,e[1]=u,e[5]=o*l,e[9]=-a*l,e[2]=-c*l,e[6]=d*u+m,e[10]=f-p*u}else if(t.order==="XZY"){const f=o*h,d=o*c,m=a*h,p=a*c;e[0]=h*l,e[4]=-u,e[8]=c*l,e[1]=f*u+p,e[5]=o*l,e[9]=d*u-m,e[2]=m*u-d,e[6]=a*l,e[10]=p*u+f}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(hu,t,cu)}lookAt(t,e,n){const r=this.elements;return rt.subVectors(t,e),rt.lengthSq()===0&&(rt.z=1),rt.normalize(),Ut.crossVectors(n,rt),Ut.lengthSq()===0&&(Math.abs(n.z)===1?rt.x+=1e-4:rt.z+=1e-4,rt.normalize(),Ut.crossVectors(n,rt)),Ut.normalize(),ri.crossVectors(rt,Ut),r[0]=Ut.x,r[4]=ri.x,r[8]=rt.x,r[1]=Ut.y,r[5]=ri.y,r[9]=rt.y,r[2]=Ut.z,r[6]=ri.z,r[10]=rt.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,o=n[0],a=n[4],h=n[8],c=n[12],l=n[1],u=n[5],f=n[9],d=n[13],m=n[2],p=n[6],y=n[10],x=n[14],g=n[3],A=n[7],b=n[11],E=n[15],M=r[0],w=r[4],R=r[8],U=r[12],S=r[1],B=r[5],z=r[9],I=r[13],T=r[2],F=r[6],C=r[10],P=r[14],D=r[3],j=r[7],ft=r[11],dt=r[15];return s[0]=o*M+a*S+h*T+c*D,s[4]=o*w+a*B+h*F+c*j,s[8]=o*R+a*z+h*C+c*ft,s[12]=o*U+a*I+h*P+c*dt,s[1]=l*M+u*S+f*T+d*D,s[5]=l*w+u*B+f*F+d*j,s[9]=l*R+u*z+f*C+d*ft,s[13]=l*U+u*I+f*P+d*dt,s[2]=m*M+p*S+y*T+x*D,s[6]=m*w+p*B+y*F+x*j,s[10]=m*R+p*z+y*C+x*ft,s[14]=m*U+p*I+y*P+x*dt,s[3]=g*M+A*S+b*T+E*D,s[7]=g*w+A*B+b*F+E*j,s[11]=g*R+A*z+b*C+E*ft,s[15]=g*U+A*I+b*P+E*dt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],s=t[12],o=t[1],a=t[5],h=t[9],c=t[13],l=t[2],u=t[6],f=t[10],d=t[14],m=t[3],p=t[7],y=t[11],x=t[15];return m*(+s*h*u-r*c*u-s*a*f+n*c*f+r*a*d-n*h*d)+p*(+e*h*d-e*c*f+s*o*f-r*o*d+r*c*l-s*h*l)+y*(+e*c*u-e*a*d-s*o*u+n*o*d+s*a*l-n*c*l)+x*(-r*a*l-e*h*u+e*a*f+r*o*u-n*o*f+n*h*l)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],u=t[9],f=t[10],d=t[11],m=t[12],p=t[13],y=t[14],x=t[15],g=u*y*c-p*f*c+p*h*d-a*y*d-u*h*x+a*f*x,A=m*f*c-l*y*c-m*h*d+o*y*d+l*h*x-o*f*x,b=l*p*c-m*u*c+m*a*d-o*p*d-l*a*x+o*u*x,E=m*u*h-l*p*h-m*a*f+o*p*f+l*a*y-o*u*y,M=e*g+n*A+r*b+s*E;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/M;return t[0]=g*w,t[1]=(p*f*s-u*y*s-p*r*d+n*y*d+u*r*x-n*f*x)*w,t[2]=(a*y*s-p*h*s+p*r*c-n*y*c-a*r*x+n*h*x)*w,t[3]=(u*h*s-a*f*s-u*r*c+n*f*c+a*r*d-n*h*d)*w,t[4]=A*w,t[5]=(l*y*s-m*f*s+m*r*d-e*y*d-l*r*x+e*f*x)*w,t[6]=(m*h*s-o*y*s-m*r*c+e*y*c+o*r*x-e*h*x)*w,t[7]=(o*f*s-l*h*s+l*r*c-e*f*c-o*r*d+e*h*d)*w,t[8]=b*w,t[9]=(m*u*s-l*p*s-m*n*d+e*p*d+l*n*x-e*u*x)*w,t[10]=(o*p*s-m*a*s+m*n*c-e*p*c-o*n*x+e*a*x)*w,t[11]=(l*a*s-o*u*s-l*n*c+e*u*c+o*n*d-e*a*d)*w,t[12]=E*w,t[13]=(l*p*r-m*u*r+m*n*f-e*p*f-l*n*y+e*u*y)*w,t[14]=(m*a*r-o*p*r-m*n*h+e*p*h+o*n*y-e*a*y)*w,t[15]=(o*u*r-l*a*r+l*n*h-e*u*h-o*n*f+e*a*f)*w,this}scale(t){const e=this.elements,n=t.x,r=t.y,s=t.z;return e[0]*=n,e[4]*=r,e[8]*=s,e[1]*=n,e[5]*=r,e[9]*=s,e[2]*=n,e[6]*=r,e[10]*=s,e[3]*=n,e[7]*=r,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),s=1-n,o=t.x,a=t.y,h=t.z,c=s*o,l=s*a;return this.set(c*o+n,c*a-r*h,c*h+r*a,0,c*a+r*h,l*a+n,l*h-r*o,0,c*h-r*a,l*h+r*o,s*h*h+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,s,o){return this.set(1,n,s,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,s=e._x,o=e._y,a=e._z,h=e._w,c=s+s,l=o+o,u=a+a,f=s*c,d=s*l,m=s*u,p=o*l,y=o*u,x=a*u,g=h*c,A=h*l,b=h*u,E=n.x,M=n.y,w=n.z;return r[0]=(1-(p+x))*E,r[1]=(d+b)*E,r[2]=(m-A)*E,r[3]=0,r[4]=(d-b)*M,r[5]=(1-(f+x))*M,r[6]=(y+g)*M,r[7]=0,r[8]=(m+A)*w,r[9]=(y-g)*w,r[10]=(1-(f+p))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let s=me.set(r[0],r[1],r[2]).length();const o=me.set(r[4],r[5],r[6]).length(),a=me.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),t.x=r[12],t.y=r[13],t.z=r[14],yt.copy(this);const c=1/s,l=1/o,u=1/a;return yt.elements[0]*=c,yt.elements[1]*=c,yt.elements[2]*=c,yt.elements[4]*=l,yt.elements[5]*=l,yt.elements[6]*=l,yt.elements[8]*=u,yt.elements[9]*=u,yt.elements[10]*=u,e.setFromRotationMatrix(yt),n.x=s,n.y=o,n.z=a,this}makePerspective(t,e,n,r,s,o,a=Qe){const h=this.elements,c=2*s/(e-t),l=2*s/(n-r),u=(e+t)/(e-t),f=(n+r)/(n-r);let d,m;if(a===Qe)d=-(o+s)/(o-s),m=-2*o*s/(o-s);else if(a===gr)d=-o/(o-s),m=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return h[0]=c,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=l,h[9]=f,h[13]=0,h[2]=0,h[6]=0,h[10]=d,h[14]=m,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(t,e,n,r,s,o,a=Qe){const h=this.elements,c=1/(e-t),l=1/(n-r),u=1/(o-s),f=(e+t)*c,d=(n+r)*l;let m,p;if(a===Qe)m=(o+s)*u,p=-2*u;else if(a===gr)m=s*u,p=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return h[0]=2*c,h[4]=0,h[8]=0,h[12]=-f,h[1]=0,h[5]=2*l,h[9]=0,h[13]=-d,h[2]=0,h[6]=0,h[10]=p,h[14]=-m,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const me=new _,yt=new ot,hu=new _(0,0,0),cu=new _(1,1,1),Ut=new _,ri=new _,rt=new _,wr=new ot,Er=new We;class Oi{constructor(t=0,e=0,n=0,r=Oi.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,s=r[0],o=r[4],a=r[8],h=r[1],c=r[5],l=r[9],u=r[2],f=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(et(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,c),this._z=0);break;case"YXZ":this._x=Math.asin(-et(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(h,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(et(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(h,s));break;case"ZYX":this._y=Math.asin(-et(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(h,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(et(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-et(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-l,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return wr.makeRotationFromQuaternion(t),this.setFromRotationMatrix(wr,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Er.setFromEuler(this),this.setFromQuaternion(Er,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Oi.DEFAULT_ORDER="XYZ";class lu{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let uu=0;const Sr=new _,pe=new We,Tt=new ot,si=new _,Be=new _,fu=new _,du=new We,Tr=new _(1,0,0),Fr=new _(0,1,0),vr=new _(0,0,1),mu={type:"added"},Rr={type:"removed"};class ut extends ki{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:uu++}),this.uuid=Ge(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ut.DEFAULT_UP.clone();const t=new _,e=new Oi,n=new We,r=new _(1,1,1);function s(){n.setFromEuler(e,!1)}function o(){e.setFromQuaternion(n,void 0,!1)}e._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ot},normalMatrix:{value:new qt}}),this.matrix=new ot,this.matrixWorld=new ot,this.matrixAutoUpdate=ut.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ut.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new lu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return pe.setFromAxisAngle(t,e),this.quaternion.multiply(pe),this}rotateOnWorldAxis(t,e){return pe.setFromAxisAngle(t,e),this.quaternion.premultiply(pe),this}rotateX(t){return this.rotateOnAxis(Tr,t)}rotateY(t){return this.rotateOnAxis(Fr,t)}rotateZ(t){return this.rotateOnAxis(vr,t)}translateOnAxis(t,e){return Sr.copy(t).applyQuaternion(this.quaternion),this.position.add(Sr.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Tr,t)}translateY(t){return this.translateOnAxis(Fr,t)}translateZ(t){return this.translateOnAxis(vr,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Tt.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?si.copy(t):si.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Be.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tt.lookAt(Be,si,this.up):Tt.lookAt(si,Be,this.up),this.quaternion.setFromRotationMatrix(Tt),r&&(Tt.extractRotation(r.matrixWorld),pe.setFromRotationMatrix(Tt),this.quaternion.premultiply(pe.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(mu)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Rr)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Rr)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Tt.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Tt.multiply(t.parent.matrixWorld)),t.applyMatrix4(Tt),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getObjectsByProperty(t,e){let n=[];this[t]===e&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(t,e);o.length>0&&(n=n.concat(o))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Be,t,fu),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Be,du,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){const s=e[n];(s.matrixWorldAutoUpdate===!0||t===!0)&&s.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,h){return a[h.uuid]===void 0&&(a[h.uuid]=h.toJSON(t)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const h=a.shapes;if(Array.isArray(h))for(let c=0,l=h.length;c<l;c++){const u=h[c];s(t.shapes,u)}else s(t.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let h=0,c=this.material.length;h<c;h++)a.push(s(t.materials,this.material[h]));r.material=a}else r.material=s(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const h=this.animations[a];r.animations.push(s(t.animations,h))}}if(e){const a=o(t.geometries),h=o(t.materials),c=o(t.textures),l=o(t.images),u=o(t.shapes),f=o(t.skeletons),d=o(t.animations),m=o(t.nodes);a.length>0&&(n.geometries=a),h.length>0&&(n.materials=h),c.length>0&&(n.textures=c),l.length>0&&(n.images=l),u.length>0&&(n.shapes=u),f.length>0&&(n.skeletons=f),d.length>0&&(n.animations=d),m.length>0&&(n.nodes=m)}return n.object=r,n;function o(a){const h=[];for(const c in a){const l=a[c];delete l.metadata,h.push(l)}return h}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}ut.DEFAULT_UP=new _(0,1,0);ut.DEFAULT_MATRIX_AUTO_UPDATE=!0;ut.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const xt=new _,Ft=new _,cn=new _,vt=new _,ye=new _,xe=new _,zr=new _,ln=new _,un=new _,fn=new _;let oi=!1;class gt{constructor(t=new _,e=new _,n=new _){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),xt.subVectors(t,e),r.cross(xt);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(t,e,n,r,s){xt.subVectors(r,e),Ft.subVectors(n,e),cn.subVectors(t,e);const o=xt.dot(xt),a=xt.dot(Ft),h=xt.dot(cn),c=Ft.dot(Ft),l=Ft.dot(cn),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const f=1/u,d=(c*h-a*l)*f,m=(o*l-a*h)*f;return s.set(1-d-m,m,d)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,vt),vt.x>=0&&vt.y>=0&&vt.x+vt.y<=1}static getUV(t,e,n,r,s,o,a,h){return oi===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),oi=!0),this.getInterpolation(t,e,n,r,s,o,a,h)}static getInterpolation(t,e,n,r,s,o,a,h){return this.getBarycoord(t,e,n,r,vt),h.setScalar(0),h.addScaledVector(s,vt.x),h.addScaledVector(o,vt.y),h.addScaledVector(a,vt.z),h}static isFrontFacing(t,e,n,r){return xt.subVectors(n,e),Ft.subVectors(t,e),xt.cross(Ft).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return xt.subVectors(this.c,this.b),Ft.subVectors(this.a,this.b),xt.cross(Ft).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return gt.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return gt.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,s){return oi===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),oi=!0),gt.getInterpolation(t,this.a,this.b,this.c,e,n,r,s)}getInterpolation(t,e,n,r,s){return gt.getInterpolation(t,this.a,this.b,this.c,e,n,r,s)}containsPoint(t){return gt.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return gt.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,s=this.c;let o,a;ye.subVectors(r,n),xe.subVectors(s,n),ln.subVectors(t,n);const h=ye.dot(ln),c=xe.dot(ln);if(h<=0&&c<=0)return e.copy(n);un.subVectors(t,r);const l=ye.dot(un),u=xe.dot(un);if(l>=0&&u<=l)return e.copy(r);const f=h*u-l*c;if(f<=0&&h>=0&&l<=0)return o=h/(h-l),e.copy(n).addScaledVector(ye,o);fn.subVectors(t,s);const d=ye.dot(fn),m=xe.dot(fn);if(m>=0&&d<=m)return e.copy(s);const p=d*c-h*m;if(p<=0&&c>=0&&m<=0)return a=c/(c-m),e.copy(n).addScaledVector(xe,a);const y=l*m-d*u;if(y<=0&&u-l>=0&&d-m>=0)return zr.subVectors(s,r),a=(u-l)/(u-l+(d-m)),e.copy(r).addScaledVector(zr,a);const x=1/(y+p+f);return o=p*x,a=f*x,e.copy(n).addScaledVector(ye,o).addScaledVector(xe,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let pu=0;class Fe extends ki{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:pu++}),this.uuid=Ge(),this.name="",this.type="Material",this.blending=pr,this.side=Rn,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=kl,this.blendDst=Ul,this.blendEquation=Nl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ol,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Xl,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Zi,this.stencilZFail=Zi,this.stencilZPass=Zi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const r=this[e];if(r===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==pr&&(n.blending=this.blending),this.side!==Rn&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const h=s[a];delete h.metadata,o.push(h)}return o}if(e){const s=r(t.textures),o=r(t.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const r=e.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=e[s].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}const Qs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_t={h:0,s:0,l:0},ai={h:0,s:0,l:0};function dn(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*6*(2/3-e):i}class Bt{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(e===void 0&&n===void 0){const r=t;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=lt){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,pt.toWorkingColorSpace(this,e),this}setRGB(t,e,n,r=pt.workingColorSpace){return this.r=t,this.g=e,this.b=n,pt.toWorkingColorSpace(this,r),this}setHSL(t,e,n,r=pt.workingColorSpace){if(t=Yl(t,1),e=et(e,0,1),n=et(n,0,1),e===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+e):n+e-n*e,o=2*n-s;this.r=dn(o,s,t+1/3),this.g=dn(o,s,t),this.b=dn(o,s,t-1/3)}return pt.toWorkingColorSpace(this,r),this}setStyle(t,e=lt){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=lt){const n=Qs[t.toLowerCase()];return n!==void 0?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Ee(t.r),this.g=Ee(t.g),this.b=Ee(t.b),this}copyLinearToSRGB(t){return this.r=tn(t.r),this.g=tn(t.g),this.b=tn(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=lt){return pt.fromWorkingColorSpace(Z.copy(this),t),Math.round(et(Z.r*255,0,255))*65536+Math.round(et(Z.g*255,0,255))*256+Math.round(et(Z.b*255,0,255))}getHexString(t=lt){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=pt.workingColorSpace){pt.fromWorkingColorSpace(Z.copy(this),e);const n=Z.r,r=Z.g,s=Z.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let h,c;const l=(a+o)/2;if(a===o)h=0,c=0;else{const u=o-a;switch(c=l<=.5?u/(o+a):u/(2-o-a),o){case n:h=(r-s)/u+(r<s?6:0);break;case r:h=(s-n)/u+2;break;case s:h=(n-r)/u+4;break}h/=6}return t.h=h,t.s=c,t.l=l,t}getRGB(t,e=pt.workingColorSpace){return pt.fromWorkingColorSpace(Z.copy(this),e),t.r=Z.r,t.g=Z.g,t.b=Z.b,t}getStyle(t=lt){pt.fromWorkingColorSpace(Z.copy(this),t);const e=Z.r,n=Z.g,r=Z.b;return t!==lt?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(t,e,n){return this.getHSL(_t),_t.h+=t,_t.s+=e,_t.l+=n,this.setHSL(_t.h,_t.s,_t.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(_t),t.getHSL(ai);const n=Ji(_t.h,ai.h,e),r=Ji(_t.s,ai.s,e),s=Ji(_t.l,ai.l,e);return this.setHSL(n,r,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,r=this.b,s=t.elements;return this.r=s[0]*e+s[3]*n+s[6]*r,this.g=s[1]*e+s[4]*n+s[7]*r,this.b=s[2]*e+s[5]*n+s[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Z=new Bt;Bt.NAMES=Qs;class yu extends Fe{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ys,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const G=new _,hi=new J;class Se{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n,this.usage=_r,this.updateRange={offset:0,count:-1},this.gpuType=ql,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)hi.fromBufferAttribute(this,e),hi.applyMatrix3(t),this.setXY(e,hi.x,hi.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)G.fromBufferAttribute(this,e),G.applyMatrix3(t),this.setXYZ(e,G.x,G.y,G.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)G.fromBufferAttribute(this,e),G.applyMatrix4(t),this.setXYZ(e,G.x,G.y,G.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)G.fromBufferAttribute(this,e),G.applyNormalMatrix(t),this.setXYZ(e,G.x,G.y,G.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)G.fromBufferAttribute(this,e),G.transformDirection(t),this.setXYZ(e,G.x,G.y,G.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Ke(e,this.array)),e}setX(t,e){return this.normalized&&(e=nt(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Ke(e,this.array)),e}setY(t,e){return this.normalized&&(e=nt(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Ke(e,this.array)),e}setZ(t,e){return this.normalized&&(e=nt(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Ke(e,this.array)),e}setW(t,e){return this.normalized&&(e=nt(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=nt(e,this.array),n=nt(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=nt(e,this.array),n=nt(n,this.array),r=nt(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,s){return t*=this.itemSize,this.normalized&&(e=nt(e,this.array),n=nt(n,this.array),r=nt(r,this.array),s=nt(s,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==_r&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}}class xu extends Se{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class _u extends Se{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class zt extends Se{constructor(t,e,n){super(new Float32Array(t),e,n)}}let gu=0;const at=new ot,mn=new ut,_e=new _,st=new qe,Ce=new qe,q=new _;class ne extends ki{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gu++}),this.uuid=Ge(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Zl(t)?_u:xu)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new qt().getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return at.makeRotationFromQuaternion(t),this.applyMatrix4(at),this}rotateX(t){return at.makeRotationX(t),this.applyMatrix4(at),this}rotateY(t){return at.makeRotationY(t),this.applyMatrix4(at),this}rotateZ(t){return at.makeRotationZ(t),this.applyMatrix4(at),this}translate(t,e,n){return at.makeTranslation(t,e,n),this.applyMatrix4(at),this}scale(t,e,n){return at.makeScale(t,e,n),this.applyMatrix4(at),this}lookAt(t){return mn.lookAt(t),mn.updateMatrix(),this.applyMatrix4(mn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_e).negate(),this.translate(_e.x,_e.y,_e.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=t[n];e.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new zt(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qe);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new _(-1/0,-1/0,-1/0),new _(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const s=e[n];st.setFromBufferAttribute(s),this.morphTargetsRelative?(q.addVectors(this.boundingBox.min,st.min),this.boundingBox.expandByPoint(q),q.addVectors(this.boundingBox.max,st.max),this.boundingBox.expandByPoint(q)):(this.boundingBox.expandByPoint(st.min),this.boundingBox.expandByPoint(st.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ui);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new _,1/0);return}if(t){const n=this.boundingSphere.center;if(st.setFromBufferAttribute(t),e)for(let s=0,o=e.length;s<o;s++){const a=e[s];Ce.setFromBufferAttribute(a),this.morphTargetsRelative?(q.addVectors(st.min,Ce.min),st.expandByPoint(q),q.addVectors(st.max,Ce.max),st.expandByPoint(q)):(st.expandByPoint(Ce.min),st.expandByPoint(Ce.max))}st.getCenter(n);let r=0;for(let s=0,o=t.count;s<o;s++)q.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(q));if(e)for(let s=0,o=e.length;s<o;s++){const a=e[s],h=this.morphTargetsRelative;for(let c=0,l=a.count;c<l;c++)q.fromBufferAttribute(a,c),h&&(_e.fromBufferAttribute(t,c),q.add(_e)),r=Math.max(r,n.distanceToSquared(q))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,r=e.position.array,s=e.normal.array,o=e.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Se(new Float32Array(4*a),4));const h=this.getAttribute("tangent").array,c=[],l=[];for(let S=0;S<a;S++)c[S]=new _,l[S]=new _;const u=new _,f=new _,d=new _,m=new J,p=new J,y=new J,x=new _,g=new _;function A(S,B,z){u.fromArray(r,S*3),f.fromArray(r,B*3),d.fromArray(r,z*3),m.fromArray(o,S*2),p.fromArray(o,B*2),y.fromArray(o,z*2),f.sub(u),d.sub(u),p.sub(m),y.sub(m);const I=1/(p.x*y.y-y.x*p.y);isFinite(I)&&(x.copy(f).multiplyScalar(y.y).addScaledVector(d,-p.y).multiplyScalar(I),g.copy(d).multiplyScalar(p.x).addScaledVector(f,-y.x).multiplyScalar(I),c[S].add(x),c[B].add(x),c[z].add(x),l[S].add(g),l[B].add(g),l[z].add(g))}let b=this.groups;b.length===0&&(b=[{start:0,count:n.length}]);for(let S=0,B=b.length;S<B;++S){const z=b[S],I=z.start,T=z.count;for(let F=I,C=I+T;F<C;F+=3)A(n[F+0],n[F+1],n[F+2])}const E=new _,M=new _,w=new _,R=new _;function U(S){w.fromArray(s,S*3),R.copy(w);const B=c[S];E.copy(B),E.sub(w.multiplyScalar(w.dot(B))).normalize(),M.crossVectors(R,B);const I=M.dot(l[S])<0?-1:1;h[S*4]=E.x,h[S*4+1]=E.y,h[S*4+2]=E.z,h[S*4+3]=I}for(let S=0,B=b.length;S<B;++S){const z=b[S],I=z.start,T=z.count;for(let F=I,C=I+T;F<C;F+=3)U(n[F+0]),U(n[F+1]),U(n[F+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Se(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let f=0,d=n.count;f<d;f++)n.setXYZ(f,0,0,0);const r=new _,s=new _,o=new _,a=new _,h=new _,c=new _,l=new _,u=new _;if(t)for(let f=0,d=t.count;f<d;f+=3){const m=t.getX(f+0),p=t.getX(f+1),y=t.getX(f+2);r.fromBufferAttribute(e,m),s.fromBufferAttribute(e,p),o.fromBufferAttribute(e,y),l.subVectors(o,s),u.subVectors(r,s),l.cross(u),a.fromBufferAttribute(n,m),h.fromBufferAttribute(n,p),c.fromBufferAttribute(n,y),a.add(l),h.add(l),c.add(l),n.setXYZ(m,a.x,a.y,a.z),n.setXYZ(p,h.x,h.y,h.z),n.setXYZ(y,c.x,c.y,c.z)}else for(let f=0,d=e.count;f<d;f+=3)r.fromBufferAttribute(e,f+0),s.fromBufferAttribute(e,f+1),o.fromBufferAttribute(e,f+2),l.subVectors(o,s),u.subVectors(r,s),l.cross(u),n.setXYZ(f+0,l.x,l.y,l.z),n.setXYZ(f+1,l.x,l.y,l.z),n.setXYZ(f+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)q.fromBufferAttribute(t,e),q.normalize(),t.setXYZ(e,q.x,q.y,q.z)}toNonIndexed(){function t(a,h){const c=a.array,l=a.itemSize,u=a.normalized,f=new c.constructor(h.length*l);let d=0,m=0;for(let p=0,y=h.length;p<y;p++){a.isInterleavedBufferAttribute?d=h[p]*a.data.stride+a.offset:d=h[p]*l;for(let x=0;x<l;x++)f[m++]=c[d++]}return new Se(f,l,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new ne,n=this.index.array,r=this.attributes;for(const a in r){const h=r[a],c=t(h,n);e.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const h=[],c=s[a];for(let l=0,u=c.length;l<u;l++){const f=c[l],d=t(f,n);h.push(d)}e.morphAttributes[a]=h}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,h=o.length;a<h;a++){const c=o[a];e.addGroup(c.start,c.count,c.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const c in h)h[c]!==void 0&&(t[c]=h[c]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const h in n){const c=n[h];t.data.attributes[h]=c.toJSON(t.data)}const r={};let s=!1;for(const h in this.morphAttributes){const c=this.morphAttributes[h],l=[];for(let u=0,f=c.length;u<f;u++){const d=c[u];l.push(d.toJSON(t.data))}l.length>0&&(r[h]=l,s=!0)}s&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const r=t.attributes;for(const c in r){const l=r[c];this.setAttribute(c,l.clone(e))}const s=t.morphAttributes;for(const c in s){const l=[],u=s[c];for(let f=0,d=u.length;f<d;f++)l.push(u[f].clone(e));this.morphAttributes[c]=l}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let c=0,l=o.length;c<l;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const h=t.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ir=new ot,Qt=new Jn,ci=new Ui,Br=new _,ge=new _,be=new _,Me=new _,pn=new _,li=new _,ui=new J,fi=new J,di=new J,Cr=new _,Pr=new _,Dr=new _,mi=new _,pi=new _;class Lr extends ut{constructor(t=new ne,e=new yu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(t,e){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;e.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(s&&a){li.set(0,0,0);for(let h=0,c=s.length;h<c;h++){const l=a[h],u=s[h];l!==0&&(pn.fromBufferAttribute(u,t),o?li.addScaledVector(pn,l):li.addScaledVector(pn.sub(e),l))}e.add(li)}return e}raycast(t,e){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),ci.copy(n.boundingSphere),ci.applyMatrix4(s),Qt.copy(t.ray).recast(t.near),!(ci.containsPoint(Qt.origin)===!1&&(Qt.intersectSphere(ci,Br)===null||Qt.origin.distanceToSquared(Br)>(t.far-t.near)**2))&&(Ir.copy(s).invert(),Qt.copy(t.ray).applyMatrix4(Ir),!(n.boundingBox!==null&&Qt.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(t,e,Qt)))}_computeIntersections(t,e,n){let r;const s=this.geometry,o=this.material,a=s.index,h=s.attributes.position,c=s.attributes.uv,l=s.attributes.uv1,u=s.attributes.normal,f=s.groups,d=s.drawRange;if(a!==null)if(Array.isArray(o))for(let m=0,p=f.length;m<p;m++){const y=f[m],x=o[y.materialIndex],g=Math.max(y.start,d.start),A=Math.min(a.count,Math.min(y.start+y.count,d.start+d.count));for(let b=g,E=A;b<E;b+=3){const M=a.getX(b),w=a.getX(b+1),R=a.getX(b+2);r=yi(this,x,t,n,c,l,u,M,w,R),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=y.materialIndex,e.push(r))}}else{const m=Math.max(0,d.start),p=Math.min(a.count,d.start+d.count);for(let y=m,x=p;y<x;y+=3){const g=a.getX(y),A=a.getX(y+1),b=a.getX(y+2);r=yi(this,o,t,n,c,l,u,g,A,b),r&&(r.faceIndex=Math.floor(y/3),e.push(r))}}else if(h!==void 0)if(Array.isArray(o))for(let m=0,p=f.length;m<p;m++){const y=f[m],x=o[y.materialIndex],g=Math.max(y.start,d.start),A=Math.min(h.count,Math.min(y.start+y.count,d.start+d.count));for(let b=g,E=A;b<E;b+=3){const M=b,w=b+1,R=b+2;r=yi(this,x,t,n,c,l,u,M,w,R),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=y.materialIndex,e.push(r))}}else{const m=Math.max(0,d.start),p=Math.min(h.count,d.start+d.count);for(let y=m,x=p;y<x;y+=3){const g=y,A=y+1,b=y+2;r=yi(this,o,t,n,c,l,u,g,A,b),r&&(r.faceIndex=Math.floor(y/3),e.push(r))}}}}function bu(i,t,e,n,r,s,o,a){let h;if(t.side===Ll?h=n.intersectTriangle(o,s,r,!0,a):h=n.intersectTriangle(r,s,o,t.side===Rn,a),h===null)return null;pi.copy(a),pi.applyMatrix4(i.matrixWorld);const c=e.ray.origin.distanceTo(pi);return c<e.near||c>e.far?null:{distance:c,point:pi.clone(),object:i}}function yi(i,t,e,n,r,s,o,a,h,c){i.getVertexPosition(a,ge),i.getVertexPosition(h,be),i.getVertexPosition(c,Me);const l=bu(i,t,e,n,ge,be,Me,mi);if(l){r&&(ui.fromBufferAttribute(r,a),fi.fromBufferAttribute(r,h),di.fromBufferAttribute(r,c),l.uv=gt.getInterpolation(mi,ge,be,Me,ui,fi,di,new J)),s&&(ui.fromBufferAttribute(s,a),fi.fromBufferAttribute(s,h),di.fromBufferAttribute(s,c),l.uv1=gt.getInterpolation(mi,ge,be,Me,ui,fi,di,new J),l.uv2=l.uv1),o&&(Cr.fromBufferAttribute(o,a),Pr.fromBufferAttribute(o,h),Dr.fromBufferAttribute(o,c),l.normal=gt.getInterpolation(mi,ge,be,Me,Cr,Pr,Dr,new _),l.normal.dot(n.direction)>0&&l.normal.multiplyScalar(-1));const u={a,b:h,c,normal:new _,materialIndex:0};gt.getNormal(ge,be,Me,u.normal),l.face=u}return l}class Mu extends ut{constructor(){super(),this.isGroup=!0,this.type="Group"}}class wi extends Fe{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Bt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const Nr=new _,kr=new _,Ur=new ot,yn=new Jn,xi=new Ui;class Au extends ut{constructor(t=new ne,e=new wi){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position,n=[0];for(let r=1,s=e.count;r<s;r++)Nr.fromBufferAttribute(e,r-1),kr.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=Nr.distanceTo(kr);t.setAttribute("lineDistance",new zt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,s=t.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),xi.copy(n.boundingSphere),xi.applyMatrix4(r),xi.radius+=s,t.ray.intersectsSphere(xi)===!1)return;Ur.copy(r).invert(),yn.copy(t.ray).applyMatrix4(Ur);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=a*a,c=new _,l=new _,u=new _,f=new _,d=this.isLineSegments?2:1,m=n.index,y=n.attributes.position;if(m!==null){const x=Math.max(0,o.start),g=Math.min(m.count,o.start+o.count);for(let A=x,b=g-1;A<b;A+=d){const E=m.getX(A),M=m.getX(A+1);if(c.fromBufferAttribute(y,E),l.fromBufferAttribute(y,M),yn.distanceSqToSegment(c,l,f,u)>h)continue;f.applyMatrix4(this.matrixWorld);const R=t.ray.origin.distanceTo(f);R<t.near||R>t.far||e.push({distance:R,point:u.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}else{const x=Math.max(0,o.start),g=Math.min(y.count,o.start+o.count);for(let A=x,b=g-1;A<b;A+=d){if(c.fromBufferAttribute(y,A),l.fromBufferAttribute(y,A+1),yn.distanceSqToSegment(c,l,f,u)>h)continue;f.applyMatrix4(this.matrixWorld);const M=t.ray.origin.distanceTo(f);M<t.near||M>t.far||e.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const Or=new _,Vr=new _;class Gr extends Au{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position,n=[];for(let r=0,s=e.count;r<s;r+=2)Or.fromBufferAttribute(e,r),Vr.fromBufferAttribute(e,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+Or.distanceTo(Vr);t.setAttribute("lineDistance",new zt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class De extends Fe{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Bt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const Wr=new ot,zn=new Jn,_i=new Ui,gi=new _;class xn extends ut{constructor(t=new ne,e=new De){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,s=t.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),_i.copy(n.boundingSphere),_i.applyMatrix4(r),_i.radius+=s,t.ray.intersectsSphere(_i)===!1)return;Wr.copy(r).invert(),zn.copy(t.ray).applyMatrix4(Wr);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=a*a,c=n.index,u=n.attributes.position;if(c!==null){const f=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);for(let m=f,p=d;m<p;m++){const y=c.getX(m);gi.fromBufferAttribute(u,y),qr(gi,y,h,r,t,e,this)}}else{const f=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);for(let m=f,p=d;m<p;m++)gi.fromBufferAttribute(u,m),qr(gi,m,h,r,t,e,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function qr(i,t,e,n,r,s,o){const a=zn.distanceSqToPoint(i);if(a<e){const h=new _;zn.closestPointToPoint(i,h),h.applyMatrix4(n);const c=r.ray.origin.distanceTo(h);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:h,index:t,face:null,object:o})}}class wu extends Fe{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Bt(16777215),this.specular=new Bt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Bt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$l,this.normalScale=new J(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ys,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}const jr={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Eu{constructor(t,e,n){const r=this;let s=!1,o=0,a=0,h;const c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(l){a++,s===!1&&r.onStart!==void 0&&r.onStart(l,o,a),s=!0},this.itemEnd=function(l){o++,r.onProgress!==void 0&&r.onProgress(l,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(l){r.onError!==void 0&&r.onError(l)},this.resolveURL=function(l){return h?h(l):l},this.setURLModifier=function(l){return h=l,this},this.addHandler=function(l,u){return c.push(l,u),this},this.removeHandler=function(l){const u=c.indexOf(l);return u!==-1&&c.splice(u,2),this},this.getHandler=function(l){for(let u=0,f=c.length;u<f;u+=2){const d=c[u],m=c[u+1];if(d.global&&(d.lastIndex=0),d.test(l))return m}return null}}}const Su=new Eu;class Qn{constructor(t){this.manager=t!==void 0?t:Su,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,s){n.load(t,r,e,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}Qn.DEFAULT_MATERIAL_NAME="__DEFAULT";const Rt={};class Tu extends Error{constructor(t,e){super(t),this.response=e}}class Fu extends Qn{constructor(t){super(t)}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=jr.get(t);if(s!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(s),this.manager.itemEnd(t)},0),s;if(Rt[t]!==void 0){Rt[t].push({onLoad:e,onProgress:n,onError:r});return}Rt[t]=[],Rt[t].push({onLoad:e,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,h=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const l=Rt[t],u=c.body.getReader(),f=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),d=f?parseInt(f):0,m=d!==0;let p=0;const y=new ReadableStream({start(x){g();function g(){u.read().then(({done:A,value:b})=>{if(A)x.close();else{p+=b.byteLength;const E=new ProgressEvent("progress",{lengthComputable:m,loaded:p,total:d});for(let M=0,w=l.length;M<w;M++){const R=l[M];R.onProgress&&R.onProgress(E)}x.enqueue(b),g()}})}}});return new Response(y)}else throw new Tu(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(h){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(l=>new DOMParser().parseFromString(l,a));case"json":return c.json();default:if(a===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),f=u&&u[1]?u[1].toLowerCase():void 0,d=new TextDecoder(f);return c.arrayBuffer().then(m=>d.decode(m))}}}).then(c=>{jr.add(t,c);const l=Rt[t];delete Rt[t];for(let u=0,f=l.length;u<f;u++){const d=l[u];d.onLoad&&d.onLoad(c)}}).catch(c=>{const l=Rt[t];if(l===void 0)throw this.manager.itemError(t),c;delete Rt[t];for(let u=0,f=l.length;u<f;u++){const d=l[u];d.onError&&d.onError(c)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Xs}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Xs);const vu=/^[og]\s*(.+)?/,Ru=/^mtllib /,zu=/^usemtl /,Iu=/^usemap /,Hr=/\s+/,$r=new _,_n=new _,Xr=new _,Yr=new _,ht=new _,bi=new Bt;function Bu(){const i={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=e!==!1;return}const n=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:o!==void 0?o.smooth:this.smooth,groupStart:o!==void 0?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(h){const c={index:typeof h=="number"?h:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},n&&n.name&&typeof n.clone=="function"){const r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/3)*3},parseNormalIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/3)*3},parseUVIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/2)*2},addVertex:function(t,e,n){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[t+0],r[t+1],r[t+2]),s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){const r=this.normals,s=this.object.geometry.normals;s.push(r[t+0],r[t+1],r[t+2]),s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(t,e,n){const r=this.vertices,s=this.object.geometry.normals;$r.fromArray(r,t),_n.fromArray(r,e),Xr.fromArray(r,n),ht.subVectors(Xr,_n),Yr.subVectors($r,_n),ht.cross(Yr),ht.normalize(),s.push(ht.x,ht.y,ht.z),s.push(ht.x,ht.y,ht.z),s.push(ht.x,ht.y,ht.z)},addColor:function(t,e,n){const r=this.colors,s=this.object.geometry.colors;r[t]!==void 0&&s.push(r[t+0],r[t+1],r[t+2]),r[e]!==void 0&&s.push(r[e+0],r[e+1],r[e+2]),r[n]!==void 0&&s.push(r[n+0],r[n+1],r[n+2])},addUV:function(t,e,n){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[t+0],r[t+1]),s.push(r[e+0],r[e+1]),s.push(r[n+0],r[n+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,r,s,o,a,h,c){const l=this.vertices.length;let u=this.parseVertexIndex(t,l),f=this.parseVertexIndex(e,l),d=this.parseVertexIndex(n,l);if(this.addVertex(u,f,d),this.addColor(u,f,d),a!==void 0&&a!==""){const m=this.normals.length;u=this.parseNormalIndex(a,m),f=this.parseNormalIndex(h,m),d=this.parseNormalIndex(c,m),this.addNormal(u,f,d)}else this.addFaceNormal(u,f,d);if(r!==void 0&&r!==""){const m=this.uvs.length;u=this.parseUVIndex(r,m),f=this.parseUVIndex(s,m),d=this.parseUVIndex(o,m),this.addUV(u,f,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let n=0,r=t.length;n<r;n++){const s=this.parseVertexIndex(t[n],e);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let s=0,o=t.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(t[s],n));for(let s=0,o=e.length;s<o;s++)this.addUVLine(this.parseUVIndex(e[s],r))}};return i.startObject("",!1),i}class Cu extends Qn{constructor(t){super(t),this.materials=null}load(t,e,n,r){const s=this,o=new Fu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(a){try{e(s.parse(a))}catch(h){r?r(h):console.error(h),s.manager.itemError(t)}},n,r)}setMaterials(t){return this.materials=t,this}parse(t){const e=new Bu;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r=[];for(let a=0,h=n.length;a<h;a++){const c=n[a].trimStart();if(c.length===0)continue;const l=c.charAt(0);if(l!=="#")if(l==="v"){const u=c.split(Hr);switch(u[0]){case"v":e.vertices.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])),u.length>=7?(bi.setRGB(parseFloat(u[4]),parseFloat(u[5]),parseFloat(u[6])).convertSRGBToLinear(),e.colors.push(bi.r,bi.g,bi.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]));break;case"vt":e.uvs.push(parseFloat(u[1]),parseFloat(u[2]));break}}else if(l==="f"){const f=c.slice(1).trim().split(Hr),d=[];for(let p=0,y=f.length;p<y;p++){const x=f[p];if(x.length>0){const g=x.split("/");d.push(g)}}const m=d[0];for(let p=1,y=d.length-1;p<y;p++){const x=d[p],g=d[p+1];e.addFace(m[0],x[0],g[0],m[1],x[1],g[1],m[2],x[2],g[2])}}else if(l==="l"){const u=c.substring(1).trim().split(" ");let f=[];const d=[];if(c.indexOf("/")===-1)f=u;else for(let m=0,p=u.length;m<p;m++){const y=u[m].split("/");y[0]!==""&&f.push(y[0]),y[1]!==""&&d.push(y[1])}e.addLineGeometry(f,d)}else if(l==="p"){const f=c.slice(1).trim().split(" ");e.addPointGeometry(f)}else if((r=vu.exec(c))!==null){const u=(" "+r[0].slice(1).trim()).slice(1);e.startObject(u)}else if(zu.test(c))e.object.startMaterial(c.substring(7).trim(),e.materialLibraries);else if(Ru.test(c))e.materialLibraries.push(c.substring(7).trim());else if(Iu.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(l==="s"){if(r=c.split(" "),r.length>1){const f=r[1].trim().toLowerCase();e.object.smooth=f!=="0"&&f!=="off"}else e.object.smooth=!0;const u=e.object.currentMaterial();u&&(u.smooth=e.object.smooth)}else{if(c==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}e.finalize();const s=new Mu;if(s.materialLibraries=[].concat(e.materialLibraries),!(e.objects.length===1&&e.objects[0].geometry.vertices.length===0)===!0)for(let a=0,h=e.objects.length;a<h;a++){const c=e.objects[a],l=c.geometry,u=c.materials,f=l.type==="Line",d=l.type==="Points";let m=!1;if(l.vertices.length===0)continue;const p=new ne;p.setAttribute("position",new zt(l.vertices,3)),l.normals.length>0&&p.setAttribute("normal",new zt(l.normals,3)),l.colors.length>0&&(m=!0,p.setAttribute("color",new zt(l.colors,3))),l.hasUVIndices===!0&&p.setAttribute("uv",new zt(l.uvs,2));const y=[];for(let g=0,A=u.length;g<A;g++){const b=u[g],E=b.name+"_"+b.smooth+"_"+m;let M=e.materials[E];if(this.materials!==null){if(M=this.materials.create(b.name),f&&M&&!(M instanceof wi)){const w=new wi;Fe.prototype.copy.call(w,M),w.color.copy(M.color),M=w}else if(d&&M&&!(M instanceof De)){const w=new De({size:10,sizeAttenuation:!1});Fe.prototype.copy.call(w,M),w.color.copy(M.color),w.map=M.map,M=w}}M===void 0&&(f?M=new wi:d?M=new De({size:1,sizeAttenuation:!1}):M=new wu,M.name=b.name,M.flatShading=!b.smooth,M.vertexColors=m,e.materials[E]=M),y.push(M)}let x;if(y.length>1){for(let g=0,A=u.length;g<A;g++){const b=u[g];p.addGroup(b.groupStart,b.groupCount,g)}f?x=new Gr(p,y):d?x=new xn(p,y):x=new Lr(p,y)}else f?x=new Gr(p,y[0]):d?x=new xn(p,y[0]):x=new Lr(p,y[0]);x.name=c.name,s.add(x)}else if(e.vertices.length>0){const a=new De({size:1,sizeAttenuation:!1}),h=new ne;h.setAttribute("position",new zt(e.vertices,3)),e.colors.length>0&&e.colors[0]!==void 0&&(h.setAttribute("color",new zt(e.colors,3)),a.vertexColors=!0);const c=new xn(h,a);s.add(c)}return s}}const gn=` 
    uniform mat4 u_worldViewProjection;
    uniform vec3 u_lightWorldPos;
    uniform mat4 u_world;
    uniform mat4 u_viewInverse;
    uniform mat4 u_worldInverse;

    attribute vec4 position;
    attribute vec3 normal;
    attribute vec2 texcoord;

    varying vec4 v_position;
    varying vec2 v_texCoord;
    varying vec3 v_normal;
    varying vec3 v_surface;
    varying vec3 v_viewSurface;

    void main() {
    v_texCoord = texcoord;
    v_position = u_worldViewProjection * position;
    v_normal = (u_worldInverse * vec4(normal, 0)).xyz;
    v_surface = u_lightWorldPos - (u_world * position).xyz;
    v_viewSurface = (u_viewInverse[3] - (u_world * position)).xyz;
    gl_Position = v_position;
    }`,bn=`
    precision mediump float;

    vec4 light(float l ,float h, float m) {
        return vec4(1.0,
                    max(l, 0.0),
                    (l > 0.0) ? pow(max(0.0, h), m) : 0.0,
                    1.0);
      }

    varying vec4 v_position;
    varying vec2 v_texCoord;
    varying vec3 v_normal;
    varying vec3 v_surface;
    varying vec3 v_viewSurface;

    uniform vec4 u_lightColor;
    uniform vec4 u_ambient;
    uniform vec4 u_specular;
    uniform float u_shininess;
    uniform float u_specularFactor;
    uniform sampler2D u_diffuse;

    void main() {
      vec4 diffuseColor = texture2D(u_diffuse, v_texCoord);
      vec3 a_normal = normalize(v_normal);
      vec3 surface = normalize(v_surface);
      vec3 viewSurface = normalize(v_viewSurface);
      vec3 hV = normalize(surface + viewSurface);
      vec4 litR = light(dot(a_normal, surface),
                        dot(a_normal, hV), u_shininess);
      vec4 outColor = vec4((
      u_lightColor * (diffuseColor * litR.y + diffuseColor * u_ambient +
                    u_specular * litR.z * u_specularFactor)).rgb,
          diffuseColor.a);
      gl_FragColor = outColor;
    }`;async function Ks(i){Pu(),Du();var t=Pl(document.getElementById("glCanvas"));if(!t)return;var e=!0,n=!1,r=[0,400,0,1],s=[0,0,0,1],o=0;const a=350,h=[0,0,0,1],c=[0,400,0,1];function l(){o++;let T=document.getElementById("score");T.innerHTML="Score: "+o}function u(){n=!0;let T=document.getElementById("death");T.style.display="block";let F=3;T.innerHTML="Oh no! You've died.<br>Redeploying in: "+F,setInterval(()=>{F--,T.innerHTML="Oh no! You've died.<br>Redeploying in: "+F,F===0&&window.location.reload()},1e3)}function f(){const T=new Ht(s).to([0,5,0,1],250).easing(ct.Sinusoidal.In).onUpdate(()=>{}).onComplete(()=>{e=!0});T.start(),T.repeat(1/0),T.yoyo(!0),document.addEventListener("click",F),document.addEventListener("keydown",F);function F(C){if(e){if(C.screenX!==void 0){const P=r;e=!1;let D=[];r[1]==c[1]?D=h:D=c,new Ht(P).to(D,a).easing(ct.Back.Out).onUpdate(()=>{r=P}).onComplete(()=>{e=!0}).start()}if(C.key==="w"){const P=r;e=!1,new Ht(P).to(c,a).easing(ct.Back.Out).onUpdate(()=>{r=P}).onComplete(()=>{e=!0}).start()}if(C.key==="s"){const P=r;e=!1,new Ht(P).to(h,a).easing(ct.Back.Out).onUpdate(()=>{r=P}).onComplete(()=>{e=!0}).start()}}}}f();var d=Hi(t,[gn,bn]),m=Hi(t,[gn,bn]),p=Hi(t,[gn,bn]);const y=await Mn("/rocket/10475_Rocket_Ship_v1_L3.obj"),x=await Mn("/asteroid/10464_Asteroid_v1_Iterations-2.obj"),g=await Mn("/planets/13913_Sun_v2_l3.obj"),A=y.map(T=>je(t,T)),b=g.map(T=>je(t,T)),E=qi(t,{min:t.NEAREST,mag:t.NEAREST,src:"/rocket/10475_Rocket_Ship_v1_Diffuse.jpg",flipY:!0}),M=qi(t,{min:t.NEAREST,mag:t.NEAREST,src:"/asteroid/10464_Asteroid_v1_diffuse.jpg",flipY:!0}),w=qi(t,{min:t.NEAREST,mag:t.NEAREST,src:"/planets/13913_Sun_diff.jpg",flipY:!0});let R=Ae(10);new Ht([R]).to([Ae(90)],1e3).easing(ct.Quadratic.Out).onUpdate(T=>{R=T}).start();let S=[];setInterval(()=>{if(Math.random()>=.5){var T=[0,0,2e3];new Ht(T).to([0,0,-1e3],1500).easing(ct.Linear.None).onUpdate(D=>{D[2]<325&&D[2]>0&&r[1]<=75&&u()}).onComplete(()=>{S.shift()}).start();var F={bufferInfo:x.map(D=>je(t,D)),position:T,rotationSpeed:Math.floor(Math.random()*(70-30+1)+30)}}else{var C=[0,400,2e3];new Ht(C).to([0,400,-1e3],1500).easing(ct.Linear.None).onUpdate(j=>{j[2]<325&&j[2]>0&&r[1]>=325&&u()}).onComplete(()=>{S.shift()}).start();var F={bufferInfo:x.map(j=>je(t,j)),position:C,rotationSpeed:Math.floor(Math.random()*(70-30+1)+30)}}S.push(F)},i==="easy"?500:350);var z=0;function I(T){if(n)return;T*=.001,Dl(t.canvas),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(0,0,0,0),t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const F=t.canvas.clientWidth/t.canvas.clientHeight,C=.5,P=5e3,D=L.perspective(R,F,C,P),j=[600,0,0],ft=[0,0,0],dt=[0,1,0],jt=L.lookAt(j,ft,dt),re=L.inverse(jt),Ct=L.multiply(D,re),tt=L.translate(L.rotateY(L.identity(),Ae(270)),Mo.create(0,-250,-250));var V={u_lightWorldPos:[1e3,80,1e3],u_lightColor:[1,1,.5,1],u_ambient:[.4,.4,.4,1],u_specular:[1,1,1,1],u_shininess:15,u_specularFactor:1,u_diffuse:E};V.u_viewInverse=jt,V.u_world=tt,V.u_worldInverse=L.transpose(L.inverse(tt)),V.u_worldViewProjection=L.rotateZ(L.translate(L.translate(L.multiply(Ct,tt),r),s),Ae(180)),t.useProgram(d.program),A.forEach(it=>{Ai(d,V),ji(t,d,it),$i(t,it)});var V={u_lightWorldPos:[1e3,80,1e3],u_lightColor:[1,1,.5,1],u_ambient:[.4,.4,.4,1],u_specular:[0,0,0,1],u_shininess:5,u_specularFactor:.8,u_diffuse:E};S.forEach(it=>{V.u_diffuse=M,V.u_world=tt,V.u_worldInverse=L.transpose(L.inverse(tt)),V.u_worldViewProjection=L.scale(L.rotateZ(L.translate(L.multiply(Ct,tt),it.position),Ae(T*it.rotationSpeed)),[.1,.1,.1]),t.useProgram(m.program),Ai(m,V),ji(t,m,it.bufferInfo[0]),$i(t,it.bufferInfo[0])});var V={u_lightWorldPos:[0,0,0],u_lightColor:[1,1,.5,1],u_ambient:[.9,.9,.9,1],u_specular:[1,1,1,1],u_shininess:75,u_specularFactor:.8,u_diffuse:E};V.u_diffuse=w,V.u_world=tt,V.u_worldInverse=L.transpose(L.inverse(tt)),V.u_worldViewProjection=L.scale(L.rotateY(L.translate(L.multiply(Ct,tt),[-1e3,200,3500]),Ae(T*10)),[3,3,3]),t.useProgram(p.program),b.forEach(it=>{Ai(p,V),ji(t,p,it),$i(t,it)}),T>=z+1&&(l(),z=T),requestAnimationFrame(I),io()}requestAnimationFrame(I)}document.getElementById("easybutton").addEventListener("click",function(){Ks("easy")},!1);document.getElementById("hardbutton").addEventListener("click",function(){Ks("hard")},!1);function Pu(){let i=document.getElementById("centered");i.style.display="none";let t=document.getElementById("score");t.innerHTML="Score: 0",t.style.display="block"}function Du(){let i=new Audio("./sound/mainmenu.mp3");i.loop=!0,i.volume=.03,i.play()}function Ae(i){return i*Math.PI/180}function Lu(i){return new Cu().loadAsync(i)}async function Mn(i){return(await Lu(i)).children.map(n=>({position:{numComponents:3,data:n.geometry.attributes.position.array},normal:{numComponents:3,data:n.geometry.attributes.normal.array},texcoord:{numComponents:2,data:n.geometry.attributes.uv.array}}))}
